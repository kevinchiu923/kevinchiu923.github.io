<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>從威脅應變到治理韌性：全面解析 NIST SP 800-61r3 的戰略轉型</title>
      <link href="//post/%E5%BE%9E%E5%A8%81%E8%84%85%E6%87%89%E8%AE%8A%E5%88%B0%E6%B2%BB%E7%90%86%E9%9F%8C%E6%80%A7%EF%BC%9A%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90-NIST-SP-800-61r3-%E7%9A%84%E6%88%B0%E7%95%A5%E8%BD%89%E5%9E%8B.html"/>
      <url>//post/%E5%BE%9E%E5%A8%81%E8%84%85%E6%87%89%E8%AE%8A%E5%88%B0%E6%B2%BB%E7%90%86%E9%9F%8C%E6%80%A7%EF%BC%9A%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90-NIST-SP-800-61r3-%E7%9A%84%E6%88%B0%E7%95%A5%E8%BD%89%E5%9E%8B.html</url>
      
        <content type="html"><![CDATA[<h2 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h2><p><strong><a href="https://doi.org/10.6028/NIST.SP.800-61r3">NIST SP 800-61r3</a> 全名為：<br>Incident Response Recommendations and Considerations for Cybersecurity Risk Management: A CSF 2.0 Community Profile</strong></p><p>是<a href="https://www.nist.gov/">美國國家標準與技術研究院（NIST, National Institute of Standards and Technology）</a>於 2025 年 4 月發布的網路安全應變指導文件，屬於NIST 800 系列標準之一，專注於事件應變管理，幫助組織建立和優化事件應變計畫，符合最新的網路安全風險管理實務和框架要求。</p><p>面對如今供應鏈攻擊激增、勒索軟體即服務（RaaS）橫行、以及多雲環境日益複雜，傳統的事件應變策略已難以應付。</p><p>相較於過往偏重資安事件處置流程的版本，NIST SP 800-61r3 不再只是單純描述「怎麼處理資安事件」，而是 <strong>將資安事件應變 (Incident Response, IR) 重塑為企業資安風險治理的一環並全面納入組織的資安風險治理架構中，並明確接軌 <a href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.29.pdf">NIST CSF 2.0 框架</a></strong>，制定貫穿組織治理、強化資安韌性的作戰方針。</p><blockquote><p>簡單來說，我認為此版本最大的差異在於 <strong>「組織文化與角色認知的轉變」</strong>:<br><strong>事件應變不再只是技術部門的責任，而是整個組織應共同參與的風險治理事項</strong></p></blockquote><p>此外，NIST 800 系列文件是 NIST 為資訊安全提供的廣泛指導之一，涵蓋風險評估、存取控制、隱私保護等多方面，SP 800-61r3 則專注於資安事件應變策略這一特定領域。</p><h2 id="事件應變架構重塑：從-CSF-2-0-看-IR-定位"><a href="#事件應變架構重塑：從-CSF-2-0-看-IR-定位" class="headerlink" title="事件應變架構重塑：從 CSF 2.0 看 IR 定位"></a>事件應變架構重塑：從 CSF 2.0 看 IR 定位</h2><p>首先我們先來談談 NIST CSF 2.0 框架；此框架將資安治理分為六大核心功能（Functions），每一項皆與資安威脅應變密切相關：</p><table><thead><tr><th>Function</th><th>功能描述</th><th>在事件應變的角色</th></tr></thead><tbody><tr><td><strong>Govern (治理&#x2F;GV)</strong></td><td>治理與政策制定</td><td>建立事件應變政策、角色、職責與決策權限</td></tr><tr><td><strong>Identify (識別&#x2F;ID)</strong></td><td>資產與風險識別</td><td>識別受威脅資產、關鍵業務流程與潛在威脅模型</td></tr><tr><td><strong>Protect (防護&#x2F;PR)</strong></td><td>預防措施</td><td>降低風險發生之可能性與潛在影響</td></tr><tr><td><strong>Detect (偵測&#x2F;DE)</strong></td><td>偵測與監控</td><td>發現惡意行為、異常徵象與入侵徵兆</td></tr><tr><td><strong>Respond (應變&#x2F;RS)</strong></td><td>應變行動</td><td>處置已確認事件，包括溝通、隔離、根除</td></tr><tr><td><strong>Recover (復原&#x2F;RC)</strong></td><td>恢復運作</td><td>復原受損服務、分析根因並改善防禦策略</td></tr></tbody></table><h2 id="新舊概念轉變：從「流程導向」轉為「治理導向」"><a href="#新舊概念轉變：從「流程導向」轉為「治理導向」" class="headerlink" title="新舊概念轉變：從「流程導向」轉為「治理導向」"></a>新舊概念轉變：從「流程導向」轉為「治理導向」</h2><p>要理解 SP 800-61r3 轉型後的概念差異，我們可以與之前一版本 SP 800-61r2（2012）進行對照：</p><table><thead><tr><th><strong>SP 800-61r2（2012）</strong></th><th><strong>SP 800-61r3（2025）</strong></th></tr></thead><tbody><tr><td>IR 是獨立週期：<br>Preparation → Detection → Containment → Recovery</td><td>IR 被整合進 CSF 2.0 的整體風險管理流程</td></tr><tr><td>強調技術流程與事件週期</td><td>強調跨部門治理與制度整合</td></tr><tr><td>著重鑑識、事件調查取證、技術分析</td><td>著重組織角色責任、決策權限與資安文化</td></tr><tr><td>文件內提供詳細流程指引</td><td>具體操作細節交給 CPRT，聚焦於「思維框架與策略原則」</td></tr></tbody></table><p>在舊版 SP 800-61r2 中定義了事件應變的四個主要階段，組成一個持續循環的應變生命週期模型。<br>這四個主要階段分別為:</p><ul><li>Preparation（準備階段）→ 打造事件應變的基礎能力與預防機制。</li><li>Detection and Analysis（偵測與分析階段）→ 快速辨識事件並判斷其性質、範圍與影響。</li><li>Containment, Eradication, and Recovery（抑制、根除與復原階段）→ 控制事件範圍、消除威脅根源並恢復業務運作。</li><li>Post-Incident Activity（事後回顧與改進階段）→ 從事件中學習與優化整體防禦能力。</li></ul><p><img src="https://kevinchiu923.github.io/post/%E5%BE%9E%E5%A8%81%E8%84%85%E6%87%89%E8%AE%8A%E5%88%B0%E6%B2%BB%E7%90%86%E9%9F%8C%E6%80%A7%EF%BC%9A%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90-NIST-SP-800-61r3-%E7%9A%84%E6%88%B0%E7%95%A5%E8%BD%89%E5%9E%8B/SP_800-61r2.png" alt="image"><span class="image-caption">image</span><br><em>Ref. <a href="https://doi.org/10.6028/NIST.SP.800-61r3">NIST SP 800-61r3</a></em></p><p>新版本 SP 800-61r3 則接軌 CSF 2.0 框架的六大核心功能細化提出新的資安事件應變生命週期模型 (Incident Response Life Cycle Model)。<br>使得模型不再是「封閉式的步驟循環」，而是導入一種以資安風險為核心、具高彈性的「動態治理模式」。<br><img src="https://kevinchiu923.github.io/post/%E5%BE%9E%E5%A8%81%E8%84%85%E6%87%89%E8%AE%8A%E5%88%B0%E6%B2%BB%E7%90%86%E9%9F%8C%E6%80%A7%EF%BC%9A%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90-NIST-SP-800-61r3-%E7%9A%84%E6%88%B0%E7%95%A5%E8%BD%89%E5%9E%8B/SP_800-61r3.png" alt="image"><span class="image-caption">image</span><br><em>Ref. <a href="https://doi.org/10.6028/NIST.SP.800-61r3">NIST SP 800-61r3</a></em></p><p>具體對應如下表:</p><table><thead><tr><th><strong>SP 800-61r2</strong></th><th><strong>SP 800-61r3（結合 CSF 2.0）</strong></th></tr></thead><tbody><tr><td>Preparation</td><td>- Govern  <br> - Identify (all Categories) <br> - Protect</td></tr><tr><td>Detection &amp; Analysis</td><td>- Detect  <br> - Identify (Improvement Category)</td></tr><tr><td>Containment, Eradication &amp; Recovery</td><td>- Respond  <br> - Recover <br> - Identify (Improvement Category)</td></tr><tr><td>Post-Incident Activity</td><td>- Identify (Improvement Category)</td></tr></tbody></table><h2 id="實務對應解析：CSF-2-0-Incident-Response"><a href="#實務對應解析：CSF-2-0-Incident-Response" class="headerlink" title="實務對應解析：CSF 2.0 + Incident Response"></a>實務對應解析：CSF 2.0 + Incident Response</h2><h3 id="Govern-→-治理導向"><a href="#Govern-→-治理導向" class="headerlink" title="Govern → 治理導向"></a>Govern → 治理導向</h3><blockquote><p>重點: 角色清楚、授權明確</p></blockquote><ul><li>制定事件應變政策，內容涵蓋分級標準、應變流程、權責歸屬（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/gv/gv-po/gv-po-01/">GV.PO-01</a>）</li><li>明確定義內部與供應商的角色與職責，包括內部單位與供應商（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/gv/gv-rr/gv-rr-02/">GV.RR-02</a>）</li><li>建立跨部門溝通流程（HR、法務、公關等）以應對重大事件</li></ul><p><strong>有助於將事件回應從單點技術執行轉型為組織層級的策略管理。</strong></p><h3 id="Identify-→-資產與風險盤點"><a href="#Identify-→-資產與風險盤點" class="headerlink" title="Identify → 資產與風險盤點"></a>Identify → 資產與風險盤點</h3><blockquote><p>重點: 盤點資產、辨識風險</p></blockquote><ul><li>建立&#x2F;維護完整的 IT&#x2F;OT&#x2F;雲端&#x2F;硬體&#x2F;軟體&#x2F;供應鏈資產清單（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v1-1/id/id-am/">ID.AM 系列</a>）</li><li>定期進行風險評估與威脅建模，支援事件優先順序決策（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v1-1/id/id-ra/">ID.RA 系列</a>）</li><li>將事件經驗教訓納入制度化改進（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/id/id-im/">ID.IM 系列</a>）</li></ul><p><strong>有助於提升預測準確度，並明確了解潛在&#x2F;關鍵風險點</strong></p><h3 id="Protect-→-預防為本"><a href="#Protect-→-預防為本" class="headerlink" title="Protect → 預防為本"></a>Protect → 預防為本</h3><blockquote><p>重點: 主動防禦，降低威脅發生機率</p></blockquote><ul><li>實施最小權限與身份驗證控制 (如:多因子驗證)（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-aa/pr-aa-05/">PR.AA-05</a>）</li><li>確保具備完善備份策略與資料災後恢復能力，降低勒索攻擊導致業務癱瘓風險（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ds/pr-ds-11/">PR.DS-11</a>）</li><li>建立系統強化設定與日誌保存政策（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/pr/pr-ps/pr-ps-04/">PR.PS-04</a>）</li></ul><p><strong>防禦準備不再是 better-to-have，而是事件影響可控的基礎。</strong></p><h3 id="Detect-→-及早發現"><a href="#Detect-→-及早發現" class="headerlink" title="Detect → 及早發現"></a>Detect → 及早發現</h3><blockquote><p>重點: 讓異常「被發現」而不是「事後才知道」</p></blockquote><ul><li>建立涵蓋網路、雲端、身份行為的持續監控系統（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v1-1/de/de-cm/">DE.CM 系列</a>）</li><li>整合 CTI 威脅情報、SIEM&#x2F;SOAR 工具進行事件關聯分析（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/de-ae/de-ae-07/">DE.AE-07</a>）</li><li>明確定義事件通報流程與分級標準（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/de/de-ae/de-ae-08/">DE.AE-08</a>）</li></ul><p><strong>即時能見度可加速決策效率，也決定能否及時控損。</strong></p><h3 id="Respond-→-處置執行"><a href="#Respond-→-處置執行" class="headerlink" title="Respond → 處置執行"></a>Respond → 處置執行</h3><blockquote><p>重點: 計畫化應變與團隊協作</p></blockquote><ul><li>建立分層事件通報與應變處置流程，明確劃分事件決策者（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/rs-ma/rs-ma-02/">RS.MA-02</a>、<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/rs-ma/rs-ma-03/">RS.MA-03</a>）</li><li>支援與第三方（如 CSP、MSSP）協同作戰能力</li><li>妥善記錄事件應變與證據，以利後續調查與改進（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v2-0/rs/rs-ma/rs-ma-04/">RS.MA-04</a>）</li></ul><p><strong>轉向「作戰準備」的思維，才能在關鍵時刻化被動為主動。</strong></p><h3 id="Recover-→-從復原邁向強化"><a href="#Recover-→-從復原邁向強化" class="headerlink" title="Recover → 從復原邁向強化"></a>Recover → 從復原邁向強化</h3><blockquote><p>重點: 復原不是「重開機就好」</p></blockquote><ul><li>制定復原策略並與 <a href="https://en.wikipedia.org/wiki/Business_continuity_planning">BCP</a>&#x2F;<a href="https://en.wikipedia.org/wiki/IT_disaster_recovery">DR</a>（業務持續與災難復原）整合（<a href="https://csf.tools/reference/nist-cybersecurity-framework/v1-1/rc/rc-im/">RC.IM 系列</a>）</li><li>恢復前需確認資產完整性和資料可信度，已避免殘存威脅進行後續汙染</li><li>執行事後復盤（Post-Incident Review），持續強化處理流程</li></ul><p><strong>災後復原不應只是結束，而是邁向組織韌性與學習成長的轉捩點。</strong></p><h2 id="相關工具與延伸資源"><a href="#相關工具與延伸資源" class="headerlink" title="相關工具與延伸資源"></a>相關工具與延伸資源</h2><ul><li><strong>CPRT</strong><ul><li><strong>全名</strong>：<a href="https://csrc.nist.gov/projects/cprt">Cybersecurity and Privacy Reference Tool</a></li><li><strong>功能簡介</strong>：對照 NIST 控制項、查參考案例</li><li><strong>使用情境</strong>：查詢對應 NIST 控制項、實務範例與技術參考</li></ul></li><li><strong>SP 800-150</strong><ul><li><strong>全名</strong>：<a href="https://csrc.nist.gov/pubs/sp/800/150/final">Guide to Cyber Threat Information Sharing</a></li><li><strong>功能簡介</strong>：威脅情報應用指引</li><li><strong>使用情境</strong>：用於設計、整合跨單位&#x2F;跨組織的 CTI 合作與通報機制</li></ul></li><li><strong>SP 800-84</strong><ul><li><strong>全名</strong>：<a href="https://csrc.nist.gov/pubs/sp/800/84/final">Guide to Test, Training, and Exercise Programs for IT Plans and Capabilities</a></li><li><strong>功能簡介</strong>：資安事件演練指南</li><li><strong>使用情境</strong>：適用於建立模擬攻擊與演練 SOP</li></ul></li><li><strong>SP 800-218</strong><ul><li><strong>全名</strong>：<a href="https://csrc.nist.gov/pubs/sp/800/218/final">Secure Software Development Framework (SSDF) Version 1.1: Recommendations for Mitigating the Risk of Software Vulnerabilities</a></li><li><strong>功能簡介</strong>：安全軟體開發框架（SSDF）</li><li><strong>使用情境</strong>：強化軟體供應鏈安全與內部安全開發實務</li></ul></li></ul><h2 id="現代化事件回應的策略優先事項"><a href="#現代化事件回應的策略優先事項" class="headerlink" title="現代化事件回應的策略優先事項"></a>現代化事件回應的策略優先事項</h2><p>NIST SP 800-61r3 明確指出：</p><blockquote><p><strong>IR 不再只是孤立的技術任務，而是企業風險治理的關鍵支柱。</strong></p></blockquote><p>為了有效提升組織的事件回應能力與風險因應策略，建議可從以下幾個重點著手：</p><ol><li>將事件回應計畫全面對應 CSF 2.0 六大核心功能，打造橫向協作的組織化應變模式</li><li>定期更新風險評估、威脅模擬場景，確保應變策略貼近當前威脅態勢</li><li>導入自動化與協作工具（如 SOAR）以提升應變速度與處置效率</li><li>將事後審查制度轉化為例行過程，形成持續改進的關鍵驅動力</li></ol><h2 id="高階主管與董事會的角色"><a href="#高階主管與董事會的角色" class="headerlink" title="高階主管與董事會的角色"></a>高階主管與董事會的角色</h2><p>企業的高階主管與董事成員，應確保資安事件應變能力不僅有資源支援，更必須將其納入組織營運績效的關鍵指標中，例如：</p><ul><li>營運韌性（Operational Resilience）KPI</li><li>稽核合規準備度（Audit Readiness）</li><li>治理成熟度模型（GRC Integration Metrics）</li></ul><p>資安事件應變已不再是技術部門的責任範疇，而是企業治理的一部分，必須自決策層級開始落實。</p><h2 id="結語反思"><a href="#結語反思" class="headerlink" title="結語反思"></a>結語反思</h2><p>曾經資安事件應變就像是在救火 - 有人點下了不懷好意的釣魚信、內網失守，凌晨兩點 SOC 告警大作。我們拼命止血、盡可能清理殘局、寫完事件報告後繼續撐著，直到下一場危機出現。</p><p>但這樣的模式，如今早已不敷使用 - 現在只要一次資安事件，就不只是技術面的挑戰，更是整間企業的營運危機。接踵而來的，可能是監管單位的密切關注、客戶信任的快速流失、品牌聲譽受損，還有來自董事會的一連串質疑聲等骨牌效應。</p><p>也因此，資安事件應變不該只是獨立的技術作業或一次性的流程週期，而是必須被納入企業治理策略的核心一環 – 從一開始就與企業風險策略緊密結合，提前設計、整合演練，而不是事後才亡羊補牢。<br>真正的資安成熟度，從來不是你制定了多少政策文件、建立了多少流程，而是當風暴來臨時，團隊能否在壓力之下冷靜判斷、迅速決策、精準執行，並勇於負責。</p><p>NIST SP 800-61r3 不只是流程圖的微調或表格的重新設計，它傳遞的是一個訊號 – 資安治理的標準，正在從單點流程全面轉向整體整合。</p><p>真正的韌性，並非取決於你用了什麼工具，而是建立一種跨層級、跨部門、跨供應鏈的行動文化。當 SOC 分析師、IT 管理者、營運單位、供應商與企業高層能夠協同應對，而非各自為政，組織才真正具備面對未知的能力。</p><p>說到底，韌性不是那張規劃圖畫得多漂亮，而是當整張圖都失效時，你的團隊能不能迅速轉舵、穩住陣腳、挺過迎面而來的暴風雨。</p><h2 id="延伸閱讀"><a href="#延伸閱讀" class="headerlink" title="延伸閱讀"></a>延伸閱讀</h2><ul><li><a href="https://www.eiopa.europa.eu/digital-operational-resilience-act-dora_en">Digital Operational Resilience Act (DORA，歐盟營運韌性法) – 歐洲保險和職業養老金管理局(EIOPA)</a></li><li><a href="https://www.sec.gov/newsroom/press-releases/2023-139">Cybersecurity Risk Management, Strategy, Governance, and Incident Disclosure – Final Rule Summary (2023), 美國證券交易委員會(SEC)</a></li><li><a href="https://www.sec.gov/resources-small-businesses/small-business-compliance-guides/cybersecurity-risk-management-strategy-governance-incident-disclosure">Small Entity Compliance Guide: Cybersecurity Risk Management, Strategy, Governance, and Incident Disclosure (2023), 美國證券交易委員會(SEC)</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Traditional Chinese </tag>
            
            <tag> 資安治理與策略 </tag>
            
            <tag> 資訊安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>The Hidden Power of Shim: How Windows and Linux Use It—and Why You Should Care</title>
      <link href="//post/The-Hidden-Power-of-Shim-How-Windows-and-Linux-Use-It%E2%80%94and-Why-You-Should-Care.html"/>
      <url>//post/The-Hidden-Power-of-Shim-How-Windows-and-Linux-Use-It%E2%80%94and-Why-You-Should-Care.html</url>
      
        <content type="html"><![CDATA[<p>Shim is a critical middleware component used in operating systems. Through API interception or signature verification, it provides both application compatibility and Secure Boot integrity. However, it can also serve as an attack surface for threat actors. This article focuses on the design, implementation, potential security risks, and defense strategies related to Shim.</p><h2 id="Introduction-What-is-a-Shim"><a href="#Introduction-What-is-a-Shim" class="headerlink" title="Introduction: What is a Shim?"></a>Introduction: What is a Shim?</h2><p>In computing, a <em>Shim</em> acts as an intermediary layer that bridges the gap between two incompatible system components. Much like a <a href="https://www.tfhc-oilseal.com/Gasketseal/%E5%BB%B6%E9%95%B7%E8%A8%AD%E5%82%99%E5%A3%BD%E5%91%BD,%E5%A2%9E%E5%8A%A0%E7%94%A2%E8%83%BD%E7%9A%84%E9%97%9C%E9%8D%B5%E9%9B%B6%E7%B5%84%E4%BB%B6-%E7%A9%BA%E5%A3%93%E6%B2%B9%E5%B0%81%E5%A2%8A%E7%89%87/">gasket</a> in mechanical engineering, a shim fills in the space or mismatch, enabling smooth interaction.</p><p>In computer systems, shims vary in form but share the core goal of <em>modifying or intercepting native behavior to enable compatibility or enforce security</em>. This article explores Shim implementations in two major OS platforms:</p><ul><li><strong>Windows - Application Shim</strong>: Primarily for resolving legacy software compatibility.</li><li><strong>Linux - Secure Boot Shim (UEFI environments)</strong>: Serves as the foundational trust anchor in the Secure Boot chain.</li></ul><h2 id="Comparing-Shims-in-Windows-vs-Linux"><a href="#Comparing-Shims-in-Windows-vs-Linux" class="headerlink" title="Comparing Shims in Windows vs. Linux"></a>Comparing Shims in Windows vs. Linux</h2><table><thead><tr><th>Aspect</th><th>Windows Application Shim</th><th>Linux Secure Boot Shim</th></tr></thead><tbody><tr><td><strong>Primary Use</strong></td><td>Compatibility for legacy apps</td><td>Trust anchor for Secure Boot</td></tr><tr><td><strong>Runtime Context</strong></td><td>User-mode</td><td>Early UEFI boot phase</td></tr><tr><td><strong>Main Function</strong></td><td>API interception, behavior modification</td><td>Digital signature verification (GRUB, Kernel)</td></tr><tr><td><strong>Installation</strong></td><td><code>.sdb</code> database, tool-assisted</td><td>Signed loader (distro-shipped, Microsoft-signed)</td></tr><tr><td><strong>Security Risks</strong></td><td>Shim Injection</td><td>Vulnerable outdated shim bypassing Secure Boot</td></tr><tr><td><strong>Common Use Case</strong></td><td>Internal legacy systems, old games</td><td>Dual-boot systems, cloud Linux images</td></tr></tbody></table><h2 id="Windows-Implementing-Application-Compatibility-Shims-and-Security-Implications"><a href="#Windows-Implementing-Application-Compatibility-Shims-and-Security-Implications" class="headerlink" title="Windows: Implementing Application Compatibility Shims and Security Implications"></a>Windows: Implementing Application Compatibility Shims and Security Implications</h2><h3 id="1-Use-Cases-Purpose"><a href="#1-Use-Cases-Purpose" class="headerlink" title="1. Use Cases &amp; Purpose"></a>1. Use Cases &amp; Purpose</h3><p>Windows Shims are designed to resolve compatibility issues that arise when older applications are run on newer OS versions. By intercepting API calls, the shim can masquerade version behavior or adjust logic, tricking the app into “believing” it’s still in a legacy environment.</p><h3 id="2-Core-Mechanism"><a href="#2-Core-Mechanism" class="headerlink" title="2. Core Mechanism"></a>2. Core Mechanism</h3><ul><li><strong>Shim Database ( <code>.sdb</code> )</strong>: Maps applications to associated fixes.</li><li><strong>Shim Engine</strong>: Injects DLLs and intercepts runtime APIs.</li><li><strong>Compatibility Administrator</strong>: GUI tool for customizing and deploying shim fixes.</li></ul><h3 id="3-Example-Command-to-Install-a-Shim"><a href="#3-Example-Command-to-Install-a-Shim" class="headerlink" title="3. Example Command to Install a Shim"></a>3. Example Command to Install a Shim</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># After creating the `.sdb` file using the Compatibility Administrator tool</span></span><br><span class="line">sdbinst.exe C:\path\to\custom_shim.sdb</span><br></pre></td></tr></table></figure><h3 id="4-Querying-Installed-Shim-Databases"><a href="#4-Querying-Installed-Shim-Databases" class="headerlink" title="4. Querying Installed Shim Databases"></a>4. Querying Installed Shim Databases</h3><p><strong>For Older Versions of Windows:</strong><br>If you’re using an older version of Windows (e.g., Windows 7 or 8), you can check for installed custom .sdb (Shim Database) files using the following PowerShell command, as documented in earlier technical references (Ref. [1][2]):</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query <span class="string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB&quot;</span></span><br></pre></td></tr></table></figure><p><strong>For Newer Versions of Windows:</strong><br>On more recent versions of Windows (e.g., Windows 10 or 11), the above registry path may not exist or may return nothing. This is because while the <code>AppCompat</code> database still exists, its entries are no longer guaranteed to appear under the <code>InstalledSDB</code> key. Instead, related Shim information may be spread across other registry locations.</p><p>You can use the following PowerShell commands to check for relevant Shim behaviors:</p><ul><li><p>List custom shims applied to specific executable paths:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query <span class="string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>List user-defined compatibility layers, such as those set via “Run in compatibility mode” from the right-click menu:</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query <span class="string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers&quot;</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>Why Might the InstalledSDB Key Be Missing?</strong><br>There are several possible reasons why the InstalledSDB key is not found in newer versions of Windows:</p><ol><li>Not all .sdb installations are recorded under InstalledSDB.</li><li>Some Windows editions no longer create this registry key by default.</li><li>Microsoft has shifted its approach to managing shims, increasingly favoring stricter application control mechanisms such as <a href="https://learn.microsoft.com/en-us/hololens/windows-defender-application-control-wdac">WDAC (Windows Defender Application Control)</a> and <a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/what-is-applocker">AppLocker</a>.</li></ol><h3 id="5-Common-Shim-Examples"><a href="#5-Common-Shim-Examples" class="headerlink" title="5. Common Shim Examples"></a>5. Common Shim Examples</h3><ul><li><code>VersionLie</code>: Fakes Windows version</li><li><code>ForceAdminAccess</code>: Tricks apps into thinking user is Admin</li><li><code>CorrectFilePaths</code>: Redirects paths to compatible locations</li></ul><h3 id="6-Security-Risk-Shim-Injection"><a href="#6-Security-Risk-Shim-Injection" class="headerlink" title="6. Security Risk - Shim Injection"></a>6. Security Risk - Shim Injection</h3><p>Attackers can craft <code>.sdb</code> files and use <code>sdbinst.exe</code> to silently install malicious shims. When the target application runs, the shim injects malicious logic. Notably, the APT group <a href="https://malpedia.caad.fkie.fraunhofer.de/actor/fin7">FIN7</a> has used this technique for persistent access. (Ref.[3])</p><h2 id="Linux-Shim’s-Role-in-Secure-Boot"><a href="#Linux-Shim’s-Role-in-Secure-Boot" class="headerlink" title="Linux: Shim’s Role in Secure Boot"></a>Linux: Shim’s Role in Secure Boot</h2><h3 id="1-Secure-Boot-Overview"><a href="#1-Secure-Boot-Overview" class="headerlink" title="1. Secure Boot Overview"></a>1. Secure Boot Overview</h3><p>UEFI Secure Boot ensures only signed binaries are executed during boot. Firmware trusts binaries signed by Microsoft’s UEFI CA.</p><h3 id="2-Why-Linux-Needs-Shim"><a href="#2-Why-Linux-Needs-Shim" class="headerlink" title="2. Why Linux Needs Shim"></a>2. Why Linux Needs Shim</h3><p>Shim allows distributions to sign and manage their own GRUB&#x2F;kernel updates without requiring direct Microsoft signature for every update.<br>Shim itself is Microsoft-signed, while embedded public keys inside shim verify GRUB and Linux kernel.</p><h3 id="3-Boot-Process-Flow-The-Shim-Three-Stage-Trust-Chain"><a href="#3-Boot-Process-Flow-The-Shim-Three-Stage-Trust-Chain" class="headerlink" title="3. Boot Process Flow: The Shim Three-Stage Trust Chain"></a>3. Boot Process Flow: The Shim Three-Stage Trust Chain</h3><p>The three-stage trust chain is a core architecture used in Linux systems under UEFI Secure Boot to ensure a secure and tamper-resistant boot process.</p><p>Its primary goal is to guarantee that every executable component involved in the boot sequence—from UEFI firmware to GRUB and ultimately to the Linux kernel—is cryptographically verified and trusted, ensuring integrity and authenticity throughout the chain.</p><p>This trust chain consists of four critical components in sequence: Firmware, Shim, GRUB, and the Kernel. Each stage is signed and verified by a distinct trusted authority:</p><ul><li>Firmware is typically provided and signed by the hardware vendor.</li><li>Shim is developed by the Linux distribution and signed by Microsoft to gain acceptance by the UEFI firmware.</li><li>GRUB and the Kernel are signed by the distribution itself and are verified by Shim using embedded public keys or through the MOK (Machine Owner Key) mechanism.</li></ul><p>Together, these components form a complete and auditable trust path, ensuring that only validated binaries are executed during system boot.</p><p><img src="https://kevinchiu923.github.io/post/The-Hidden-Power-of-Shim-How-Windows-and-Linux-Use-It%E2%80%94and-Why-You-Should-Care/Three-stage-Trust-Chain.jpeg"></p><p><strong>Detailed Flow:</strong><br><strong>Step 1: Firmware → Shim (Signed by Microsoft)</strong></p><table><thead><tr><th>Item</th><th>Description</th></tr></thead><tbody><tr><td>Boot Source</td><td>UEFI firmware</td></tr><tr><td>Target</td><td>shimx64.efi (provided by the Linux distribution, signed by Microsoft)</td></tr><tr><td>Verification</td><td>Verified via Microsoft UEFI CA signature</td></tr><tr><td>Purpose</td><td>Enables non-Microsoft bootloaders (e.g., GRUB) to load under Secure Boot</td></tr></tbody></table><p><strong>Step 2: Shim → GRUB (or Other Bootloaders, Signed by Distro)</strong></p><table><thead><tr><th>Item</th><th>Description</th></tr></thead><tbody><tr><td>Boot Source</td><td>shimx64.efi</td></tr><tr><td>Target</td><td>grubx64.efi (signed by the Linux distribution)</td></tr><tr><td>Verification</td><td>Verified using an embedded public key in Shim, or via the MOK (Machine Owner Key) system</td></tr><tr><td>Purpose</td><td>Loads the next-stage bootloader (e.g., GRUB) and establishes the next trust link</td></tr></tbody></table><p><strong>Step 3: GRUB → Kernel (Using Shim’s Verification Capabilities)</strong></p><table><thead><tr><th>Item</th><th>Description</th></tr></thead><tbody><tr><td>Boot Source</td><td>GRUB</td></tr><tr><td>Target</td><td>vmlinuz (Linux kernel image)</td></tr><tr><td>Verification</td><td>Verified using the signature checking modules from Shim or GRUB</td></tr><tr><td>Purpose</td><td>Ensures that the kernel being booted is cryptographically validated</td></tr></tbody></table><p>These three stages are jointly managed by Microsoft, the Linux distribution, and the system owner, forming a <strong>complete and layered trust architecture based on tiered signing and staged verification</strong>.</p><h3 id="4-Managing-Custom-Keys-MOK-Machine-Owner-Key"><a href="#4-Managing-Custom-Keys-MOK-Machine-Owner-Key" class="headerlink" title="4. Managing Custom Keys: MOK (Machine Owner Key)"></a>4. Managing Custom Keys: MOK (Machine Owner Key)</h3><p>MOK (Machine Owner Key) allows users to manually enroll custom signing keys, which can then be used to validate third-party drivers or custom-compiled Linux kernels.<br>Once enrolled, the corresponding public key is stored in <a href="https://en.wikipedia.org/wiki/Non-volatile_memory">NVRAM (non-volatile memory)</a> and becomes part of the Secure Boot validation process, handled by <a href="https://github.com/hakuna-m/wubiuefi/wiki/MOKManager">MokManager</a> during system startup.<br>Example: Importing a MOK on Ubuntu</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mokutil --import my_key_pub.der</span><br><span class="line"><span class="comment"># The system will prompt you to set a password. After a reboot, you’ll be guided through the MokManager interface to complete the key enrollment process.</span></span><br></pre></td></tr></table></figure><h3 id="5-Security-Retrospective-BootHole-and-the-Birth-of-SBAT"><a href="#5-Security-Retrospective-BootHole-and-the-Birth-of-SBAT" class="headerlink" title="5. Security Retrospective: BootHole and the Birth of SBAT"></a>5. Security Retrospective: BootHole and the Birth of SBAT</h3><p>The disclosure of the <strong><a href="https://nvd.nist.gov/vuln/detail/cve-2020-10713">BootHole vulnerability (CVE-2020-10713)</a></strong> in 2020 marked a turning point for the UEFI Secure Boot ecosystem.<br>This flaw existed in the configuration parsing logic of the GRUB2 bootloader, where an attacker could tamper with grub.cfg to inject malicious code. Alarmingly, this could occur even with Secure Boot enabled, effectively bypassing the signature verification process and executing unsigned binaries.</p><p>This incident exposed a critical single point of failure within the Secure Boot trust chain and highlighted the limitations of the traditional revocation approach (such as Microsoft’s dbx blacklist), where revoking a single vulnerable binary could inadvertently disrupt all systems using that version.</p><p>To address these systemic risks, the Linux community—in collaboration with UEFI stakeholders such as Canonical, Red Hat, and others—developed a new mechanism called <strong><a href="https://www.gnu.org/software/grub/manual/grub/html_node/Secure-Boot-Advanced-Targeting.html">SBAT (Secure Boot Advanced Targeting)</a></strong>.</p><p>SBAT introduces a more granular and version-aware revocation model, enabling Secure Boot to selectively block specific versions of vulnerable boot components—such as particular builds of shim, GRUB, or the Linux kernel—without impacting safe versions. This significantly improves the flexibility and maintainability of Secure Boot over time.</p><h2 id="Conclusion-Shim-as-a-Double-Edged-Sword"><a href="#Conclusion-Shim-as-a-Double-Edged-Sword" class="headerlink" title="Conclusion: Shim as a Double-Edged Sword"></a>Conclusion: Shim as a Double-Edged Sword</h2><p>Shim plays a bridging role in modern operating systems:</p><ul><li>In Windows, it extends the lifecycle of legacy applications by ensuring compatibility.</li><li>In Linux, it upholds the integrity and continuity of the Secure Boot trust chain.</li></ul><p>Only by thoroughly understanding how Shim works can organizations fully leverage its advantages—while proactively mitigating the potential security risks it may introduce.</p><h3 id="Why-Is-Shim-Considered-a-Double-Edged-Sword"><a href="#Why-Is-Shim-Considered-a-Double-Edged-Sword" class="headerlink" title="Why Is Shim Considered a Double-Edged Sword?"></a>Why Is Shim Considered a Double-Edged Sword?</h3><h4 id="Pros"><a href="#Pros" class="headerlink" title="Pros:"></a>Pros:</h4><ul><li><strong>Maintains Compatibility and Flexibility:</strong><br>Shim offers significant flexibility and operational convenience, allowing legacy applications or custom drivers to continue running in modern environments. This reduces both maintenance overhead and the cost of system upgrades.</li></ul><h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons:"></a>Cons:</h4><ul><li><strong>Potential Security Risks:</strong><br>The same mechanisms that offer flexibility can also be exploited as attack vectors. For example, malicious actors may leverage Shim Injection in Windows or exploit outdated shims in Linux to bypass security controls.</li><li><strong>Single Point of Failure in the Trust Chain:</strong><br>In Secure Boot environments, Shim serves as the root of trust. If Shim itself is compromised—either by a vulnerability or unauthorized replacement—the entire trust chain may be invalidated.</li><li><strong>High Maintenance and Revocation Complexity:</strong><br>Once widely deployed, updating or revoking Shim (e.g., via SBAT) can be operationally challenging. Improper updates may even prevent systems from booting, increasing the risk and complexity of incident response.</li></ul><h3 id="Mitigation-Strategies-and-Security-Recommendations"><a href="#Mitigation-Strategies-and-Security-Recommendations" class="headerlink" title="Mitigation Strategies and Security Recommendations"></a>Mitigation Strategies and Security Recommendations</h3><p>For real-world deployment, organizations and developers are strongly encouraged to implement version control, enforce signature policies, and adopt centralized management solutions. Continuous monitoring of Shim and Secure Boot–related security advisories is essential to reduce potential attack surfaces.<br>Recommended actions include:</p><ol><li><p>Maintain Compatibility with Controlled Flexibility</p><ul><li>Apply Shims only to essential legacy applications where no viable alternatives exist, avoiding unnecessary dependency across the system.</li><li>Implement a robust change management and testing process (e.g., following <a href="https://www.iso.org/standard/27001">ISO&#x2F;IEC 27001</a>, <a href="https://csrc.nist.gov/pubs/sp/800/53/r5/upd1/final">NIST 800-53</a>), including risk assessment, functional validation, and version tracking for each Shim configuration to balance compatibility with security.</li><li>Enforce application whitelisting policies using mechanisms such as <a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/what-is-applocker">AppLocker</a> or <a href="https://learn.microsoft.com/en-us/hololens/windows-defender-application-control-wdac">WDAC</a> to restrict the execution of unauthorized programs.</li></ul></li><li><p>Address Potential Security Breaches</p><ul><li>Establish monitoring systems to detect suspicious behavior such as the execution of sdbinst.exe or unusual changes to Shim databases.</li><li>Restrict Shim installation privileges to system administrators and limit access to Shim-related tools at the user level.</li><li>Conduct regular audits of %WINDIR%\AppPatch\Custom\ and relevant Shim-related registry paths to track unauthorized modifications.</li></ul></li><li><p>Mitigate Trust Chain Single Points of Failure</p><ul><li>Use only officially distributed Shim binaries signed by Microsoft to ensure integrity and trustworthiness.</li><li>Deploy SBAT-compliant Shim versions, which allow for granular revocation and precise version management.</li><li>Maintain up-to-date versions of Shim, GRUB, the Linux kernel, and UEFI firmware to reduce exposure to known vulnerabilities.</li></ul></li><li><p>Reduce Operational Overhead and Improve Revocation Response</p><ul><li>Utilize centralized management tools such as <a href="https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/what-is-intune">Microsoft Intune</a> or <a href="https://www.redhat.com/en/ansible-collaborative">Ansible</a> to streamline deployment and monitor Shim usage across environments.</li><li>Design boot recovery strategies, including USB live images or dedicated recovery partitions, to ensure system bootability in case of Shim-related failures.</li><li>Maintain version history and SHA-256 checksum records to support validation and forensic investigation when needed.</li></ul></li></ol><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol><li>Black Hat EU 2015 Whitepaper - <a href="https://www.blackhat.com/docs/eu-15/materials/eu-15-Pierce-Defending-Against-Malicious-Application-Compatibility-Shims-wp.pdf">Defending Against Malicious Application Compatibility Shims</a></li><li>F-Secure Blog Post - <a href="https://blog.f-secure.com/hunting-for-application-shim-databases/">Hunting for Application Shim Databases</a></li><li>Google Cloud - <a href="https://cloud.google.com/blog/topics/threat-intelligence/fin7-shim-databases-persistence/">FIN7 Leveraging Shim Databases</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
            <tag> Cyber security </tag>
            
            <tag> Windows </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深入解析 Shim：Windows 相容性修正與 Linux Secure Boot 信任鏈核心</title>
      <link href="//post/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90-Shim%EF%BC%9AWindows-%E7%9B%B8%E5%AE%B9%E6%80%A7%E4%BF%AE%E6%AD%A3%E8%88%87-Linux-Secure-Boot-%E4%BF%A1%E4%BB%BB%E9%8F%88%E6%A0%B8%E5%BF%83.html"/>
      <url>//post/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90-Shim%EF%BC%9AWindows-%E7%9B%B8%E5%AE%B9%E6%80%A7%E4%BF%AE%E6%AD%A3%E8%88%87-Linux-Secure-Boot-%E4%BF%A1%E4%BB%BB%E9%8F%88%E6%A0%B8%E5%BF%83.html</url>
      
        <content type="html"><![CDATA[<p>Shim 是一種關鍵的系統中介技術，透過 API 攔截或簽章驗證，提供應用程式相容性與Secure Boot 安全性，但同時也可能成為資安攻擊的切入點。<br>本文將著重介紹 Shim 的運作原理、實作方式、潛在風險與對應防護策略。</p><h2 id="前言：Shim-是什麼？"><a href="#前言：Shim-是什麼？" class="headerlink" title="前言：Shim 是什麼？"></a>前言：Shim 是什麼？</h2><p>在資訊系統中，Shim 是一種中介程式，負責「橋接」兩個不相容或無法直接溝通的系統元件；就如同機械工程中的 <a href="https://www.tfhc-oilseal.com/Gasketseal/%E5%BB%B6%E9%95%B7%E8%A8%AD%E5%82%99%E5%A3%BD%E5%91%BD,%E5%A2%9E%E5%8A%A0%E7%94%A2%E8%83%BD%E7%9A%84%E9%97%9C%E9%8D%B5%E9%9B%B6%E7%B5%84%E4%BB%B6-%E7%A9%BA%E5%A3%93%E6%B2%B9%E5%B0%81%E5%A2%8A%E7%89%87/">墊片(gasket)</a> 一樣，用來填補介面之間的落差。Shim 可以在兩個元件之間增加一層轉換層，讓它們得以協同運作。</p><p>在電腦系統中，Shim 的形式多樣，但核心目的都是<strong>攔截或調整原始行為，實現相容性或安全性</strong>；本文將深入探討 Shim 在兩個主流作業系統中的應用：</p><ul><li><strong>Windows - Application Shim</strong>：以「應用程式相容性 Shim」為主，處理老舊軟體與新系統間的相容問題。</li><li><strong>Linux - Secure Boot Shim（UEFI 環境）</strong>：Shim 作為 Secure Boot 信任鏈的第一環，確保開機流程安全性。</li></ul><h2 id="Shim-在-Windows-與-Linux-中的差異比較"><a href="#Shim-在-Windows-與-Linux-中的差異比較" class="headerlink" title="Shim 在 Windows 與 Linux 中的差異比較"></a>Shim 在 Windows 與 Linux 中的差異比較</h2><table><thead><tr><th>項目</th><th>Windows Application Shim</th><th>Linux Secure Boot Shim</th></tr></thead><tbody><tr><td>主要用途</td><td>解決舊應用與新版系統的相容性問題</td><td>建立 Secure Boot 的信任鏈起點</td></tr><tr><td>執行階段</td><td>使用者層級（User-mode）</td><td>開機初期（UEFI Boot）</td></tr><tr><td>主要功能</td><td>攔截 API、修改行為、模擬舊系統</td><td>驗證 GRUB 與 Kernel 的數位簽章</td></tr><tr><td>安裝方式</td><td>利用 <code>.sdb</code> 資料庫，透過工具安裝</td><td>隨發行版安裝的簽署程式（由微軟簽章）</td></tr><tr><td>安全風險</td><td>可被惡意利用進行 Shim Injection</td><td>過時 shim 版本有繞過 Secure Boot 的風險</td></tr><tr><td>常見應用</td><td>公司內部無法更新的舊系統、老遊戲</td><td>雙開系統、Linux 雲端映像啟動</td></tr></tbody></table><h2 id="Windows：Application-Compatibility-Shim-的實作與資安考量"><a href="#Windows：Application-Compatibility-Shim-的實作與資安考量" class="headerlink" title="Windows：Application Compatibility Shim 的實作與資安考量"></a>Windows：Application Compatibility Shim 的實作與資安考量</h2><h3 id="1-應用場景與目的"><a href="#1-應用場景與目的" class="headerlink" title="1. 應用場景與目的"></a>1. 應用場景與目的</h3><p>Windows Shim 主要解決因作業系統升級導致的應用程式不相容問題。透過<strong>攔截應用程式對 API 的呼叫</strong>，進行行為轉換或版本「偽裝」，讓老程式能「誤以為」自己仍在舊環境執行。</p><h3 id="2-核心機制與運作原理"><a href="#2-核心機制與運作原理" class="headerlink" title="2. 核心機制與運作原理"></a>2. 核心機制與運作原理</h3><ul><li><strong>Shim 資料庫（.sdb）</strong>：記錄程式與修正規則的對應。</li><li><strong>Shim Engine</strong>：動態攔截 API 呼叫，透過 DLL 注入來修改執行邏輯。</li><li><strong>Compatibility Administrator 工具</strong>：可自訂並安裝 Shim 修正組。</li></ul><h3 id="3-建立自訂-Shim-的指令範例："><a href="#3-建立自訂-Shim-的指令範例：" class="headerlink" title="3. 建立自訂 Shim 的指令範例："></a>3. 建立自訂 Shim 的指令範例：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 Compatibility Administrator 建立 .sdb 後</span></span><br><span class="line">sdbinst.exe C:\path\to\custom_shim.sdb</span><br></pre></td></tr></table></figure><h3 id="4-查詢已安裝的-Shim-資料庫"><a href="#4-查詢已安裝的-Shim-資料庫" class="headerlink" title="4. 查詢已安裝的 Shim 資料庫"></a>4. 查詢已安裝的 Shim 資料庫</h3><ul><li><p><strong>適用於舊版 Windows：</strong><br>若使用的是舊版本的 Windows (如: Windows 7&#x2F;8)，根據早期的技術資料中可以使用以下 PowerShell 指令列出安裝過的自訂 <code>.sdb</code> (參考資料 [1][2]):</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query <span class="string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>適用於新版 Windows：</strong><br>若使用的是較新版本的 Windows (如: Windows 10&#x2F;11)，以上述指令執行可能會發生查找不到的狀況。這是因為新版本中的 <code>AppCompat</code> 資料庫雖然存在，但不一定會出現在 <code>InstalledSDB</code> 下，而是散布在其他註冊機碼 (registry key) 中，可用以下兩種 PowerShell 指令查詢:</p><ul><li>列出針對特定路徑的應用程式所套用的 Shim 行為，也就是「Custom Shim」  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query <span class="string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom&quot;</span></span><br></pre></td></tr></table></figure></li><li>顯示使用者手動設定的相容性層（Compatibility Layers），例如用滑鼠右鍵設定「以 Windows 7 相容模式執行」的那些項目  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg query <span class="string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers&quot;</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><p><strong>為什麼找不到 InstalledSDB？</strong><br>至於為什麼新版本 Windows 中會有 <code>InstalledSDB</code> 缺失的問題呢? 主要原因有以下三點:</p><ol><li>並非所有 <code>.sdb</code> 安裝都會登記在 InstalledSDB 下</li><li>有些系統版本根本不建立這個鍵值</li><li>微軟改變了 Shim 的儲存或管理方式（特別是近年趨向 WDAC 和 AppLocker 等更嚴格控管）</li></ol><h3 id="5-常見-Shim-應用實例"><a href="#5-常見-Shim-應用實例" class="headerlink" title="5. 常見 Shim 應用實例"></a>5. 常見 Shim 應用實例</h3><ul><li><code>VersionLie</code>：偽裝成特定 Windows 版本</li><li><code>ForceAdminAccess</code>：欺騙應用程式認為目前使用者是 Admin</li><li><code>CorrectFilePaths</code>：將檔案路徑重導至現代系統中可用位置</li></ul><h3 id="6-資安風險：Shim-Injection"><a href="#6-資安風險：Shim-Injection" class="headerlink" title="6. 資安風險：Shim Injection"></a>6. 資安風險：Shim Injection</h3><p>攻擊者可自製 <code>.sdb</code> 檔並利用 <code>sdbinst.exe</code> 安裝至系統中，當使用者啟動特定程式時，自動注入惡意程式碼。例如<a href="https://malpedia.caad.fkie.fraunhofer.de/actor/fin7">知名駭客集團 FIN7</a> 就曾使用此技術 (參考資料 [3])。</p><h2 id="Linux：Shim-Loader-在-Secure-Boot-中的角色與實踐"><a href="#Linux：Shim-Loader-在-Secure-Boot-中的角色與實踐" class="headerlink" title="Linux：Shim Loader 在 Secure Boot 中的角色與實踐"></a>Linux：Shim Loader 在 Secure Boot 中的角色與實踐</h2><h3 id="1-Secure-Boot-簡介"><a href="#1-Secure-Boot-簡介" class="headerlink" title="1. Secure Boot 簡介"></a>1. Secure Boot 簡介</h3><p>UEFI Secure Boot 確保開機流程中執行的程式碼皆經由簽章驗證。韌體通常僅信任由微軟 UEFI CA 所簽署的開機元件。</p><h3 id="2-Linux-為什麼需要-Shim？"><a href="#2-Linux-為什麼需要-Shim？" class="headerlink" title="2. Linux 為什麼需要 Shim？"></a>2. Linux 為什麼需要 Shim？</h3><p>Linux 發行版透過 shim 避免每次 kernel 或 bootloader 更新都需向微軟簽章。<br>Shim 自身由微軟簽署，而它內嵌的發行版公鑰可用來驗證 GRUB 與 Linux kernel。</p><h3 id="3-運作流程：Shim-的三段式信任鏈-Three-stage-Trust-Chain"><a href="#3-運作流程：Shim-的三段式信任鏈-Three-stage-Trust-Chain" class="headerlink" title="3. 運作流程：Shim 的三段式信任鏈 (Three-stage Trust Chain)"></a>3. 運作流程：Shim 的三段式信任鏈 (Three-stage Trust Chain)</h3><p>三段式信任鏈是 Linux 在 UEFI Secure Boot 環境中，用以確保開機流程安全與完整性的核心架構。<br>其主要目的，是確保從 UEFI 韌體啟動開始，經由 GRUB，到最終載入 Linux 核心的每一個階段裡所執行的元件皆為經簽章驗證、未遭竄改可信的程式碼。</p><p>整體信任鏈依序包含 Firmware、Shim、GRUB 與 Kernel 四個關鍵元件，其中每一階段的簽章與驗證機制，分別由不同單位負責：<br>Firmware 通常由硬體廠商提供，Shim 則由 Linux 發行版開發並交由微軟簽章，GRUB 和 Kernel 則由發行版簽署，並透過 Shim 或 MOK 機制進行驗證，共同構成一條完整且可追溯的信任路徑。</p><p><img src="https://kevinchiu923.github.io/post/%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90-Shim%EF%BC%9AWindows-%E7%9B%B8%E5%AE%B9%E6%80%A7%E4%BF%AE%E6%AD%A3%E8%88%87-Linux-Secure-Boot-%E4%BF%A1%E4%BB%BB%E9%8F%88%E6%A0%B8%E5%BF%83/Three-stage-Trust-Chain.jpeg"></p><p>詳細流程如下：</p><p><strong>Step 1：Firmware → shim(由微軟簽署)</strong></p><table><thead><tr><th>項目</th><th>說明</th></tr></thead><tbody><tr><td>啟動元件</td><td>UEFI 固件</td></tr><tr><td>執行對象</td><td>shimx64.efi (由 Linux 發行版提供，已由微軟簽章)</td></tr><tr><td>驗證方式</td><td>使用 Microsoft UEFI CA 簽章來驗證 Shim</td></tr><tr><td>目標</td><td>讓非微軟提供的 bootloader (如 GRUB)能在 Secure Boot 下被合法載入</td></tr></tbody></table><p><strong>Step 2：shim → GRUB (或其他 bootloader)（由發行版簽署)</strong></p><table><thead><tr><th>項目</th><th>說明</th></tr></thead><tbody><tr><td>啟動元件</td><td>shimx64.efi</td></tr><tr><td>執行對象</td><td>grubx64.efi (由 Linux 發行版簽章)</td></tr><tr><td>驗證方式</td><td>使用內嵌在 Shim 中的公鑰，或從 MOK (Machine Owner Key) 資料庫驗證</td></tr><tr><td>目標</td><td>載入下一階段 bootloader (如 GRUB)，建立信任傳遞關係</td></tr></tbody></table><p><strong>Step 3：GRUB → Kernel（使用 shim 提供之驗證功能）</strong></p><table><thead><tr><th>項目</th><th>說明</th></tr></thead><tbody><tr><td>啟動元件</td><td>GRUB</td></tr><tr><td>執行對象</td><td>vmlinux (Linuex kernel 映像檔)</td></tr><tr><td>驗證方式</td><td>使用 Shim 或 GRUB 的簽章驗證模組，驗證 kernel 簽章</td></tr><tr><td>目標</td><td>確保啟動的 kernel 也經過驗證</td></tr></tbody></table><p>這三個階段分別由微軟、Linux 發行版與使用者管理，形成一條 <strong>「分層簽署、階段驗證」</strong> 的完整分層信任架構。</p><h3 id="4-管理自簽金鑰：MOK（Machine-Owner-Key）"><a href="#4-管理自簽金鑰：MOK（Machine-Owner-Key）" class="headerlink" title="4. 管理自簽金鑰：MOK（Machine Owner Key）"></a>4. 管理自簽金鑰：MOK（Machine Owner Key）</h3><p>允許使用者手動註冊自定義簽名金鑰，然後可以使用這些金鑰來驗證第三方驅動程式或自定義編譯的 Linux 內核。<br>註冊后，相應的公鑰將儲存在 <a href="https://en.wikipedia.org/wiki/Non-volatile_memory">NVRAM（非揮發記憶體）</a>中成為安全啟動驗證過程的一部分，並在 Secure Boot 流程中由 <a href="https://github.com/hakuna-m/wubiuefi/wiki/MOKManager">MokManager</a> 處理。</p><p>新增 MOK 流程（以 Ubuntu 為例）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mokutil --import my_key_pub.der</span><br><span class="line"><span class="comment"># 系統將提示設定密碼，重新開機後進入 MokManager 加入金鑰</span></span><br></pre></td></tr></table></figure><h3 id="5-相關資安風險回顧"><a href="#5-相關資安風險回顧" class="headerlink" title="5. 相關資安風險回顧"></a>5. 相關資安風險回顧</h3><p>於 2020 年爆出的 <strong>BootHole (<a href="https://nvd.nist.gov/vuln/detail/cve-2020-10713">CVE-2020-10713</a>)</strong> 漏洞，促使了整個 UEFI Secure Boot 生態系迎來一場大革新。<br>這個漏洞存在於 GRUB2 bootloader 的設定解析邏輯中，攻擊者可以藉由篡改 grub.cfg 來注入惡意程式碼，即使在 Secure Boot 啟用的情況下，也能繞過驗證機制、執行未經簽署的內容。<br>這不僅暴露了 Secure Boot 信任鏈的單點風險，更凸顯了傳統撤銷 (revocation) 機制（如 dbx）的侷限性。</p><p>為了解決這類系統性風險，Linux 社群與多家 UEFI 相關廠商（如 Canonical、Red Hat 等）合作，設計出一套名為 <strong><a href="https://www.gnu.org/software/grub/manual/grub/html_node/Secure-Boot-Advanced-Targeting.html">SBAT（Secure Boot Advanced Targeting）</a></strong> 的新機制。<br>SBAT 允許系統更精確的辨識和撤銷具有風險的開機元件版本，例如特定版本的 shim、GRUB 或 Linux kernel，避免因一次撤銷而連帶影響所有使用者與版本，提升了 Secure Boot 的彈性與可維運性。</p><h2 id="結語：Shim-是一把雙面刃"><a href="#結語：Shim-是一把雙面刃" class="headerlink" title="結語：Shim 是一把雙面刃"></a>結語：Shim 是一把雙面刃</h2><p>Shim 在現代系統中扮演橋樑角色：</p><ul><li>Windows 的 Shim 強化了舊應用程式的生命週期</li><li>Linux 的 Shim 維繫 Secure Boot 的完整性與信任鏈</li></ul><p>唯有深入理解其機制，才能有效運用其優勢、提早防範可能的安全風險。</p><h3 id="為什麼說-Shim-是雙面刃？"><a href="#為什麼說-Shim-是雙面刃？" class="headerlink" title="為什麼說 Shim 是雙面刃？"></a>為什麼說 Shim 是雙面刃？</h3><h4 id="優點："><a href="#優點：" class="headerlink" title="優點："></a>優點：</h4><ul><li><strong>維持相容與開放性</strong>：Shim 提供了強大的彈性與便利性，允許舊應用程式或自訂驅動在現代環境中繼續運作，降低維護與升級成本。</li></ul><h4 id="缺點："><a href="#缺點：" class="headerlink" title="缺點："></a>缺點：</h4><ul><li><strong>潛在安全破口</strong>：同樣的機制若被濫用，可能成為惡意程式碼的載具，例如 Windows 中的 Shim injection 或 Linux 過期 shim 被攻擊者利用。</li><li><strong>信任鏈單點風險</strong>：特別在 Secure Boot 環境中，shim 是信任鏈的起點，一旦 shim 本身有漏洞或被取代，整條信任機制將形同虛設。</li><li><strong>維護成本與撤銷困難</strong>：Shim 一旦廣泛部署，若需進行更新（如 SBAT 撤銷）常會伴隨使用者無法開機等風險與操作複雜度。</li></ul><p>因此，在部署與使用 shim 時，應同時考慮便利性與安全性，並持續追蹤官方針對 shim 更新與安全通報。</p><h3 id="因應對策與防護建議"><a href="#因應對策與防護建議" class="headerlink" title="因應對策與防護建議"></a>因應對策與防護建議</h3><p>在實際部署中，建議企業與開發人員落實版本控管、簽章政策與集中式管理機制，並持續關注 Shim 與 Secure Boot 的安全通報，以降低潛在攻擊風險。具體如下：</p><ol><li>維持相容與開放性<ul><li>僅針對無可替代的關鍵應用程式使用 Shim，避免全面啟用造成過度依賴。</li><li>導入完整的變更控管(Change Control &#x2F; Change Management) 與測試流程(如 <a href="https://www.iso.org/standard/27001">ISO&#x2F;IEC 27001</a>、<a href="https://csrc.nist.gov/pubs/sp/800/53/r5/upd1/final">NIST 800-53</a>)，針對每項 Shim 設定進行風險評估、功能驗證與版本記錄，以確保相容性需求與系統安全性之間的平衡。</li><li>搭配應用程式白名單機制（如 <a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/applocker/what-is-applocker">AppLocker</a>、<a href="https://learn.microsoft.com/en-us/hololens/windows-defender-application-control-wdac">WDAC</a>）限制執行來源。</li></ul></li><li>潛在安全破口<ul><li>建立監控機制，偵測如 sdbinst.exe 執行、異常的 Shim 資料庫變更等行為。</li><li>僅授予系統管理員權限安裝 Shim，並限制使用者層級存取 Shim 管理工具。</li><li>定期稽核 %WINDIR%\AppPatch\Custom\ 和註冊機碼下的 Shim 記錄。</li></ul></li><li>信任鏈單點風險<ul><li>僅使用官方發行、由 Microsoft 簽署的 shim 映像檔。</li><li>部署支援 SBAT 的 shim 版本，以便精確撤銷與進行版本管控。</li><li>定期更新 shim、GRUB、Kernel 與 UEFI 韌體，以防範已知漏洞。</li></ul></li><li>維護成本與撤銷困難<ul><li>使用集中化管理工具（如 <a href="https://learn.microsoft.com/en-us/intune/intune-service/fundamentals/what-is-intune">Intune</a>、<a href="https://www.redhat.com/en/ansible-collaborative">Ansible</a>）統一佈署與監控 Shim 使用情形。</li><li>規劃開機備援方案，例如 USB live 磁區、Recovery 分割區，以因應 Shim 更新後的開機失敗。</li><li>建立版本記錄與 SHA256 雜湊校驗機制，以利驗證與回溯分析。</li></ul></li></ol><h2 id="參考資料"><a href="#參考資料" class="headerlink" title="參考資料"></a>參考資料</h2><p>[1] Black Hat Europe 2015 Whitepaper -<a href="https://www.blackhat.com/docs/eu-15/materials/eu-15-Pierce-Defending-Against-Malicious-Application-Compatibility-Shims-wp.pdf">《Defending Against Malicious Application Compatibility Shims》</a><br>[2] F-Secure Blog post - <a href="https://blog.f-secure.com/hunting-for-application-shim-databases/">《Hunting for Application Shim Databases》</a><br>[3] Google Cloud - <a href="https://cloud.google.com/blog/topics/threat-intelligence/fin7-shim-databases-persistence/">To SDB, Or Not To SDB: FIN7 Leveraging Shim Databases for Persistence</a></p>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Traditional Chinese </tag>
            
            <tag> Windows </tag>
            
            <tag> Linux </tag>
            
            <tag> 資訊安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>An Overview of IEC 60870-5-104: Practical and Security Applications of the SCADA Communication Protocol</title>
      <link href="//post/An-Overview-of-IEC-60870-5-104-Practical-and-Security-Applications-of-the-SCADA-Communication-Protocol.html"/>
      <url>//post/An-Overview-of-IEC-60870-5-104-Practical-and-Security-Applications-of-the-SCADA-Communication-Protocol.html</url>
      
        <content type="html"><![CDATA[<p><img src="/post/An-Overview-of-IEC-60870-5-104-Practical-and-Security-Applications-of-the-SCADA-Communication-Protocol/cover_img.jpeg"></p><center>Source: https://www.dreamstime.com/</center><h2 id="1-Glossary-of-Technical-Terms"><a href="#1-Glossary-of-Technical-Terms" class="headerlink" title="1. Glossary of Technical Terms"></a>1. Glossary of Technical Terms</h2><ul><li><p><strong>Telemetry</strong><br>  <em>Definition：</em> The technology for collecting data from remote devices or systems and transmitting it back to a central control system. The data is typically gathered from sensors or monitoring equipment, such as temperature, pressure, or location.<br>  <em>Example：</em> A space probe transmitting its velocity, temperature, and position data back to Earth is an example of telemetry.</p></li><li><p><strong>Tele-signaling &#x2F; Remote Signaling</strong><br>  <em>Definition：</em> Transmission of status or alarm signals from remote equipment, generally as discrete data (e.g., ON&#x2F;OFF, Normal&#x2F;Failure).<br>  <em>Example：</em> A power plant control center receiving a “breaker closed” signal from a substation is an instance of remote signaling.</p></li><li><p><strong>Telecontrol &#x2F; Remote Control</strong><br>  <em>Definition：</em> Remote operation or control of devices, such as switching equipment on&#x2F;off, configuring settings, or initiating processes.<br>  <em>Example：</em> Remotely starting a factory machine or turning on an air conditioner is a form of telecontrol.</p></li><li><p><strong>DSP → Digital signal processor</strong><br>  <em>Definition：</em> A specialized microprocessor designed for high-speed numeric processing, widely used in telecommunications, audio, digital image processing, radar, sonar, and consumer electronics.</p></li><li><p><strong>RTU → Remote terminal unit</strong><br>  <em>Definition：</em> A microprocessor-based electronic device that acts as an interface to field devices and transmits telemetry data to the SCADA system while also receiving control commands.</p></li><li><p><strong>IED → Intelligent Electronic Device</strong><br>  <em>Definition：</em> An advanced electronic device capable of data processing and communication, used in power systems and industrial control for monitoring, control, protection, and communication. It goes beyond simple sensors or relays by incorporating microprocessors and communication interfaces.</p></li><li><p><strong>COT → Cause of Transmission</strong><br>  <em>Definition：</em> A critical field within the ASDU (Application Service Data Unit) in IEC 60870-5, indicating the reason for data transmission (e.g., cyclic, spontaneous, test).</p></li><li><p><strong>IOA → Information Object Address</strong><br>  <em>Definition：</em> Identifies the internal address of a specific point within a device. Each RTU or IED typically has a point list, and the IOA is used to reference those points.</p></li><li><p><strong>Frame</strong><br>  <em>Definition：</em> A basic unit of data encapsulation in industrial communication protocols, consisting of a header (Start of Frame, address, function code), payload, and CRC (error check).</p></li><li><p><strong>SCADA → Supervisory Control And Data Acquisition</strong><br>  <em>Definition：</em> A system architecture used for remote monitoring and control of large-scale industrial systems. SCADA systems enable centralized operators to oversee field devices, send control commands, and visualize&#x2F;analyze real-time data.</p></li></ul><hr><h2 id="2-Introduction-to-the-IEC-60870-5-Protocol-Series"><a href="#2-Introduction-to-the-IEC-60870-5-Protocol-Series" class="headerlink" title="2. Introduction to the IEC 60870-5 Protocol Series"></a>2. Introduction to the IEC 60870-5 Protocol Series</h2><p>IEC 60870 is a set of international communication standards developed by the <a href="https://www.iec.ch/homepage">International Electrotechnical Commission (IEC)</a> for reliable data transmission between industrial control centers (SCADA) and remote devices such as RTUs and IEDs. These standards are widely adopted in <strong>power systems, smart grids, and industrial automation</strong>.</p><p>IEC 60870-5 is Part 5 of the standard family and includes over 13 sub-standards focusing on protocols for <strong>remote control, protection, and communication</strong> in power systems.</p><p>Two commonly used sub-standards include:</p><ul><li><strong>IEC 60870-5-101 (IEC 101)</strong>: Designed for serial communication (RS-232&#x2F;RS-485), suitable for point-to-point local transmission.</li><li><strong>IEC 60870-5-104 (IEC 104)</strong>: Designed for modern network environments using TCP&#x2F;IP, enabling wide-area communication via Ethernet or VPN.</li></ul><p>In essence, IEC 104 extends the IEC 101 data structure to IP networks, allowing continuous bidirectional connections for real-time data exchange, rather than relying on traditional polling.</p><hr><h2 id="3-Mapping-IEC-104-to-the-OSI-Model"><a href="#3-Mapping-IEC-104-to-the-OSI-Model" class="headerlink" title="3. Mapping IEC 104 to the OSI Model"></a>3. Mapping IEC 104 to the OSI Model</h2><p>IEC 104 functions as an application-layer protocol and uses TCP for transport, typically operating over <strong>Port 2404</strong>.</p><p>The mapping to the OSI model is as follows:</p><ul><li><strong>Application Layer</strong>: IEC 104</li><li><strong>Transport Layer</strong>: TCP</li><li><strong>Network Layer</strong>: IP</li><li><strong>Data Link &#x2F; Physical Layer</strong>: Ethernet</li></ul><p>SCADA systems typically use a <strong>Master-Slave architecture</strong> [1] where <strong>the control center (Master) acts as the Client, and the field devices (RTUs&#x2F;IEDs) act as Servers</strong>. A persistent TCP connection is established for data exchange and control.</p><p>After connection, the client initiates communication with the <strong>StartDT</strong> command. If the server is unresponsive for too long, the <strong>TestFR</strong> command is used to verify the connection.</p><h6 id="1-Since-2020-the-terms-“Master”-and-“Slave”-have-come-under-scrutiny-in-the-tech-industry-due-to-their-historical-association-with-slavery-Companies-like-Oracle-and-GitHub-have-advocated-replacing-them-with-alternatives-like-Primary-Replica-Conductor-Member-or-Primary-Secondary-to-promote-more-inclusive-language-However-as-the-IEC-standards-were-defined-before-this-shift-and-still-reference-these-terms-we-use-them-here-strictly-for-consistency-and-clarity-in-reference-to-the-original-documentation"><a href="#1-Since-2020-the-terms-“Master”-and-“Slave”-have-come-under-scrutiny-in-the-tech-industry-due-to-their-historical-association-with-slavery-Companies-like-Oracle-and-GitHub-have-advocated-replacing-them-with-alternatives-like-Primary-Replica-Conductor-Member-or-Primary-Secondary-to-promote-more-inclusive-language-However-as-the-IEC-standards-were-defined-before-this-shift-and-still-reference-these-terms-we-use-them-here-strictly-for-consistency-and-clarity-in-reference-to-the-original-documentation" class="headerlink" title="[1] Since 2020, the terms “Master” and “Slave” have come under scrutiny in the tech industry due to their historical association with slavery. Companies like Oracle and GitHub have advocated replacing them with alternatives like Primary-Replica, Conductor-Member, or Primary-Secondary to promote more inclusive language.However, as the IEC standards were defined before this shift and still reference these terms, we use them here strictly for consistency and clarity in reference to the original documentation."></a>[1] Since 2020, the terms “Master” and “Slave” have come under scrutiny in the tech industry due to their historical association with slavery. Companies like Oracle and GitHub have advocated replacing them with alternatives like <strong>Primary-Replica, Conductor-Member, or Primary-Secondary</strong> to promote more inclusive language.<br>However, as the <strong>IEC standards</strong> were defined before this shift and still reference these terms, we use them here strictly for consistency and clarity in reference to the original documentation.</h6><hr><h2 id="4-Communication-Format-and-Data-Structure"><a href="#4-Communication-Format-and-Data-Structure" class="headerlink" title="4. Communication Format and Data Structure"></a>4. Communication Format and Data Structure</h2><p>IEC 104 uses <strong>ASDU (Application Service Data Unit)</strong> as the primary data encapsulation format. Each ASDU contains:</p><ul><li><strong>Type ID</strong>: Identifies the data type (e.g., telemetry, tele-signaling, telecontrol).</li><li><strong>Cause of Transmission (COT)</strong>: Indicates the reason for transmission (cyclic, spontaneous, test, command).</li><li><strong>Common Address &#x2F; Information Object Address (IOA)</strong>: Identifies the device and data point.</li><li><strong>Data Content</strong>: The actual transmitted value (e.g., ON&#x2F;OFF, voltage reading).</li></ul><p>IEC 104 frames are categorized into three types:</p><ul><li><strong>I-frame</strong>: Carries actual data.</li><li><strong>S-frame</strong>: Acknowledges received data.</li><li><strong>U-frame</strong>: Manages connection control (StartDT, StopDT, TestFR).</li></ul><p>Each message includes sequence numbers for flow control and error detection to ensure reliable delivery.</p><hr><h2 id="5-Real-World-Use-Case-Integrating-with-SCADA-Systems"><a href="#5-Real-World-Use-Case-Integrating-with-SCADA-Systems" class="headerlink" title="5. Real-World Use Case: Integrating with SCADA Systems"></a>5. Real-World Use Case: Integrating with SCADA Systems</h2><p>IEC 104 is a widely used protocol in modern SCADA systems.<br><strong>Examples</strong>:</p><ul><li>Siemens RTUs and WinCC SCADA systems communicate via IEC 104.</li><li>Schneider Electric’s ClearSCADA (Geo SCADA) supports IEC 104.</li><li>ABB’s MicroSCADA and RTU560 include built-in IEC 104 communication modules.</li></ul><p>These devices typically interface with IEDs (e.g., smart meters, protection relays) to receive telemetry such as:</p><ul><li>Voltage&#x2F;current fluctuations</li><li>Protection trip events</li><li>Remote control execution statuses</li></ul><p>SCADA systems are configured with matching Type IDs, COTs, and IOAs for each data point.</p><p>In cases where legacy field equipment only supports IEC 101 (serial), <strong>protocol converters</strong> or <strong>gateways</strong> (e.g., Advantech <a href="https://www.advantech.com/zh-tw/products/ac0bd5cd-093a-4f88-87f5-13edc68a5616/esrp-pcs-icr3231/mod_803b3db4-bd02-472c-8ad3-624aaaab2433">ESRP-PCS-ICR3231</a> or <a href="https://www.advantech.com/zh-tw/products/7332cf9e-bf70-4a79-b0b6-fd8a2182cd72/ecu-1051/mod_0ea5f440-e270-436f-afa3-077df3acce5d">ECU-1051</a>) can be used to convert IEC 101 to IEC 104, enabling integration into modern Ethernet-based systems.</p><hr><h2 id="6-Security-Challenges-and-Protections-under-IEC-62351"><a href="#6-Security-Challenges-and-Protections-under-IEC-62351" class="headerlink" title="6. Security Challenges and Protections under IEC 62351"></a>6. Security Challenges and Protections under IEC 62351</h2><p>IEC 104 was not originally designed with modern cybersecurity threats in mind, leading to the following issues:</p><ul><li><strong>Plaintext transmission</strong>, vulnerable to eavesdropping.</li><li><strong>Lack of authentication</strong>, allowing attackers to impersonate the master station.</li><li><strong>No encryption or integrity checks</strong>, making it prone to man-in-the-middle attacks.</li></ul><p>To address these risks, IEC introduced the <a href="https://www.iec.ch/blog/cyber-security-understanding-iec-62351"><strong>IEC 62351 series</strong></a>:</p><ul><li><a href="https://webstore.iec.ch/en/publication/68410"><strong>IEC 62351-3</strong></a>: Recommends using TLS over TCP (similar to HTTPS) to encrypt data.</li><li><a href="https://webstore.iec.ch/en/publication/65511"><strong>IEC 62351-5</strong></a>: Adds signatures and sequence protection at the application layer to prevent spoofing and replay attacks.</li><li><a href="https://webstore.iec.ch/en/publication/61822"><strong>IEC 62351-8</strong></a> &amp; <a href="https://webstore.iec.ch/en/publication/66864"><strong>IEC 62351-9</strong></a>: Define device authentication and key management methods.</li></ul><p>If devices do not support IEC 62351, <strong>VPNs</strong> or <strong>secure gateways</strong> can be used for encrypted communication or packet forwarding.</p><hr><h2 id="7-Practical-Recommendations-for-Secure-and-Stable-Deployment"><a href="#7-Practical-Recommendations-for-Secure-and-Stable-Deployment" class="headerlink" title="7. Practical Recommendations for Secure and Stable Deployment"></a>7. Practical Recommendations for Secure and Stable Deployment</h2><p>Even with IEC 62351 in place, the following best practices are recommended:</p><ul><li><strong>Network Segmentation</strong>: Isolate SCADA and control networks from corporate IT networks.</li><li><strong>Firewall Port Control</strong>: Restrict access to Port 2404 to authorized IP addresses only.</li><li><strong>Intrusion Detection Systems (IDS)</strong>: Monitor abnormal IEC 104 traffic and command patterns.</li><li><strong>Secure Gateways</strong>: Enforce data and command restrictions based on IOA and Type ID.</li><li><strong>VPN Encryption</strong>: Use secure channels for remote access.</li><li><strong>Firmware Updates</strong>: Regularly patch known vulnerabilities in devices.<br>These strategies form a <strong>defense-in-depth</strong> approach, significantly reducing the risk of successful cyberattacks.</li></ul>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
            <tag> Industrial Control System </tag>
            
            <tag> Cyber security </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>淺談 IEC 60870-5-104：SCADA 通訊協定的實務與安全應用</title>
      <link href="//post/%E6%B7%BA%E8%AB%87-IEC-60870-5-104%EF%BC%9ASCADA-%E9%80%9A%E8%A8%8A%E5%8D%94%E5%AE%9A%E7%9A%84%E5%AF%A6%E5%8B%99%E8%88%87%E5%AE%89%E5%85%A8%E6%87%89%E7%94%A8.html"/>
      <url>//post/%E6%B7%BA%E8%AB%87-IEC-60870-5-104%EF%BC%9ASCADA-%E9%80%9A%E8%A8%8A%E5%8D%94%E5%AE%9A%E7%9A%84%E5%AF%A6%E5%8B%99%E8%88%87%E5%AE%89%E5%85%A8%E6%87%89%E7%94%A8.html</url>
      
        <content type="html"><![CDATA[<p><img src="/post/%E6%B7%BA%E8%AB%87-IEC-60870-5-104%EF%BC%9ASCADA-%E9%80%9A%E8%A8%8A%E5%8D%94%E5%AE%9A%E7%9A%84%E5%AF%A6%E5%8B%99%E8%88%87%E5%AE%89%E5%85%A8%E6%87%89%E7%94%A8/cover_img.jpeg"></p><center>Source: https://www.dreamstime.com/</center><h2 id="1-專有名詞說明"><a href="#1-專有名詞說明" class="headerlink" title="1. 專有名詞說明"></a>1. 專有名詞說明</h2><ul><li><p><strong>遙測 → Telemetry</strong><br>  <em>定義：</em> 是指從遠端設備或系統收集資料並傳回主系統或控制中心的技術。這些資料通常是感測器或監控裝置所收集的，例如溫度、壓力、位置等<br>  <em>舉例：</em> 太空探測器將自身的速度、溫度、位置等資料傳回地球，這些就是「遙測」數據</p></li><li><p><strong>遙信 → Tele-signaling &#x2F; Remote Signaling</strong><br>  <em>定義：</em> 指遠端設備或系統的狀態信號的傳送，主要是傳遞狀態或告警資訊（如開&#x2F;關、正常&#x2F;故障等），通常是離散型資料<br>  <em>舉例：</em> 發電廠的控制中心收到某個變電站「開關已關閉」的狀態信號，這就是一種遙信</p></li><li><p><strong>遙控 → Telecontrol &#x2F; Remote Control</strong><br>  <em>定義：</em> 指從遠端對設備進行控制或操作，例如遠端開關機、設定參數、啟動程式等<br>  <em>舉例：</em> 遠端控制工廠機械啟動運轉、開啟空調等，這些都屬於遙控</p></li><li><p><strong>DSP → Digital signal processor (數位訊號處理器)</strong><br>  <em>定義：</em> 是一種專用於數位訊號處理的微處理器，被廣泛應用於電信、音訊處理、數位圖像處理、雷達、聲納等領域，以及消費電子產品中</p></li><li><p><strong>RTU → Remote terminal unit (遠端遙控裝置)</strong><br>  <em>定義：</em> 微控制處理器，主要做為裝置介面的電子裝置，將資料引入 SCADA，通過傳輸遙測資料 (Remote sensing data) 到主系統，並且使用主監控系統的資料控制所連接的裝置</p></li><li><p><strong>IED → Intelligent Electronic Device (智慧電子設備)</strong><br>  <em>定義：</em> 具備資料處理能力與通訊功能的電子裝置，常應用於電力系統、工業控制系統（ICS）等場景中，用於監測、控制、保護與通訊。它不只是「感測器」或「繼電器」，而是具有 微處理器、邏輯判斷、遠端通訊能力的智慧設備。</p></li><li><p><strong>COT → Cause of Transmission (傳送原因)</strong><br>  <em>定義：</em> COT 是 IEC 60870-5 協定中 ASDU（應用服務資料單元）的一個重要欄位，用來說明這筆資料為什麼被傳送，也就是傳輸的「觸發原因」</p></li><li><p><strong>IOA → Information Object Address (資訊物件地址)</strong><br>  <em>定義：</em> 用來標示該筆資料所屬的設備內部地址，也就是某個遙測點的「點號」。通常每個 RTU 或 IED 裝置裡會配置一張遙測點號表，IOA 就是用來定位這些點</p></li><li><p><strong>Frame → 訊框</strong><br>  <em>定義：</em> 在工控通訊協定中，Frame 是一個用來封裝與傳輸資料的基本單位，就像是一個信封一樣，裡面包含了標頭 (header)、資料本體 (payload)、檢查碼 (CRC) 等資訊；其中標頭 (header) 主要由起始符 (Start of Frame, SOF) 、位址&#x2F;識別位、功能碼 (表示讀、寫等指令) 組成</p></li><li><p><strong>SCADA → Supervisory Control And Data Acquisition (監控與資料採集系統)</strong><br>  <em>定義：</em> 是一種用於遠端監控與控制大型工業系統的架構，它允許操作人員從中控室監控現場設備的運作狀態，並能發送控制命令。SCADA 可收集、儲存、分析和顯示來自現場感測器和控制設備的資料</p></li></ul><hr><h2 id="2-何謂-IEC-60870-5-協定"><a href="#2-何謂-IEC-60870-5-協定" class="headerlink" title="2. 何謂 IEC 60870-5 協定"></a>2. 何謂 IEC 60870-5 協定</h2><p>IEC 60870 是一套是由 <a href="https://www.iec.ch/homepage">國際電工委員會 (IEC)</a> 制定的國際通訊標準，旨在為在工業控制中心 (SCADA) 及遠端裝置 (如: RTU&#x2F;IED) 間進行可靠的資料傳輸。現今廣泛應用在電力系統、智慧電網的監控&#x2F;控制與工業自動化系統中。<br>IEC 60870-5 則是整個家族中的第五部份，旗下包含多達 13 個子標準，主要針對電力系統的遠端控制、遠端保護和相關通信制定了協議標準。</p><p>其中最常見的兩個子標準是：</p><ul><li><strong>IEC 60870-5-101 (下稱 IEC 101)</strong>：使用傳統串列 (RS-232&#x2F;RS-485) 方式，適合本地端點對點傳輸應用。</li><li><strong>IEC 60870-5-104 (下稱 IEC 104)</strong>：是針對現代網路環境 (如: TCP&#x2F;IP) 設計的版本，針對遠端通訊的傳輸層與應用層設計，可在乙太網、VPN 等廣域網路上進行資料傳輸。</li></ul><p>簡單來說，IEC 104 就是把 IEC 101 的資料格式「搬到網路上」，讓它能走在 IP 網路上，而且支援雙向持續連線，讓資料可以即時交換，不用像老系統只能等 SCADA 輪詢。</p><hr><h2 id="3-IEC-104-與-OSI-七層模型的對應"><a href="#3-IEC-104-與-OSI-七層模型的對應" class="headerlink" title="3. IEC 104 與 OSI 七層模型的對應"></a>3. IEC 104 與 OSI 七層模型的對應</h2><p>IEC 104 在網路通訊模型中，是應用層協定，透過 TCP 傳輸，預設使用 <strong>Port 2404</strong>。</p><p>以下是它在 傳統網路 OSI 七層模型中的對應：</p><ul><li>應用層：IEC 104</li><li>傳輸層：TCP</li><li>網路層：IP</li><li>資料鏈結層&#x2F;實體層：Ethernet</li></ul><p>在 SCADA 系統中採用的是 Master-Slave 模式 (<em>註1</em>)，主站 (控制中心) 通常是 <strong>Client (用戶端)</strong> ，現場的 RTU、IED 是 <strong>Server (伺服端)</strong> ，兩者透過 TCP 建立持久性連線 (Persistent Connection) ，並進行資料交換與控制指令下達。<br>當主站連線成功後，會送出 <strong>StartDT</strong> 指令開始資料傳送；若無動作太久，也會用 <strong>TestFR</strong> 做連線測試。</p><h6 id="註1：自2020年起，美國科技界認為-Master-Slave-這樣的字眼可能反應了早期蓄奴制度而帶有潛在負面與歧視意涵，因而-Oracle、GitHub-等大廠倡議以-Source-Replica-、Conductor-Member-或是-Primary-Secondary-等新名詞取代之；但由於-IEC-相關文件制定時間較早，為讀者們參照方便，此文仍使用-Master-Slave-說明。-參考資料：MySQL-Terminology-Updates"><a href="#註1：自2020年起，美國科技界認為-Master-Slave-這樣的字眼可能反應了早期蓄奴制度而帶有潛在負面與歧視意涵，因而-Oracle、GitHub-等大廠倡議以-Source-Replica-、Conductor-Member-或是-Primary-Secondary-等新名詞取代之；但由於-IEC-相關文件制定時間較早，為讀者們參照方便，此文仍使用-Master-Slave-說明。-參考資料：MySQL-Terminology-Updates" class="headerlink" title="*註1：自2020年起，美國科技界認為 Master-Slave 這樣的字眼可能反應了早期蓄奴制度而帶有潛在負面與歧視意涵，因而 Oracle、GitHub 等大廠倡議以 Source-Replica 、Conductor-Member 或是 Primary-Secondary 等新名詞取代之；但由於 IEC 相關文件制定時間較早，為讀者們參照方便，此文仍使用 Master-Slave 說明。(參考資料：MySQL Terminology Updates)"></a>*註1：自2020年起，美國科技界認為 Master-Slave 這樣的字眼可能反應了早期蓄奴制度而帶有潛在負面與歧視意涵，因而 Oracle、GitHub 等大廠倡議以 Source-Replica 、Conductor-Member 或是 Primary-Secondary 等新名詞取代之；<br>但由於 IEC 相關文件制定時間較早，為讀者們參照方便，此文仍使用 Master-Slave 說明。(參考資料：<a href="https://dev.mysql.com/blog-archive/mysql-terminology-updates/">MySQL Terminology Updates</a>)</h6><hr><h2 id="4-通訊格式與資料結構解說"><a href="#4-通訊格式與資料結構解說" class="headerlink" title="4. 通訊格式與資料結構解說"></a>4. 通訊格式與資料結構解說</h2><p>IEC 104 的資料單元叫做 <strong>ASDU (Application Service Data Unit)</strong> ，是主要的資料封裝格式。</p><p>每個 ASDU 包含：</p><ul><li><strong>類型 ID (Type ID)</strong> ：表示這是什麼資料 (例如遙測、遙信、遙控)</li><li><strong>傳送原因 (COT)</strong> ：表示為什麼送這筆資料 (定時、變化、指令、測試等)</li><li><strong>公共地址與資訊物件地址 (IOA)</strong> ：標示資料屬於哪個裝置、哪一筆點位</li><li><strong>資料內容</strong>：實際傳輸的值 (如 ON&#x2F;OFF、電壓數值)</li></ul><p>IEC 104 使用三種 Frame 類型：</p><ol><li><strong>I-frame</strong>：攜帶實際資料</li><li><strong>S-frame</strong>：確認對方資料已收到</li><li><strong>U-frame</strong>：連線管理指令，如 StartDT、StopDT、TestFR</li></ol><p>這些報文 (message) 內含控制編號與確認編號，確保資料正確送達，並支援流量控制與錯誤偵測。</p><hr><h2 id="5-實際應用案例：如何與-SCADA-整合"><a href="#5-實際應用案例：如何與-SCADA-整合" class="headerlink" title="5. 實際應用案例：如何與 SCADA 整合"></a>5. 實際應用案例：如何與 SCADA 整合</h2><p>在現代 SCADA 系統中，IEC 104 是非常常見的通訊協定。<br>舉例來說：</p><ul><li><strong>西門子 (Siemens)</strong> 的 RTU 裝置與 WinCC SCADA 系統可以透過 IEC 104 傳送資料。</li><li><strong>施耐德電機 (Schneider Electric)</strong> 的 ClearSCADA (Geo SCADA) 也支援 IEC 104。</li><li><strong>艾波比 (ABB)</strong> 的 MicroSCADA 及 RTU560 裝置內建 IEC 104 通訊模組。</li></ul><p>這些裝置通常會與 IED (如：智慧電表、保護裝置) 回傳的遙測訊息串接，例如：</p><ul><li>電壓&#x2F;電流變化</li><li>保護跳脫事件</li><li>遙控指令執行成功與否</li></ul><p>SCADA 系統會設定對應的 Type ID、COT、IOA 等參數，來對應每一筆資料。<br>在一些場景下，若現場設備只支援 IEC 101 (串列通訊) ，可使用 <strong>協定轉換器</strong> 或 <strong>閘道器</strong> (如：研華生產的轉換器 <a href="https://www.advantech.com/zh-tw/products/ac0bd5cd-093a-4f88-87f5-13edc68a5616/esrp-pcs-icr3231/mod_803b3db4-bd02-472c-8ad3-624aaaab2433">ESRP-PCS-ICR3231</a> 及閘道器 <a href="https://www.advantech.com/zh-tw/products/7332cf9e-bf70-4a79-b0b6-fd8a2182cd72/ecu-1051/mod_0ea5f440-e270-436f-afa3-077df3acce5d">ECU-1051</a>) 將其轉成 IEC 104 接入乙太網架構，實現舊系統升級。</p><hr><h2 id="6-資安挑戰與-IEC-62351-的保護機制"><a href="#6-資安挑戰與-IEC-62351-的保護機制" class="headerlink" title="6. 資安挑戰與 IEC 62351 的保護機制"></a>6. 資安挑戰與 IEC 62351 的保護機制</h2><p>IEC 104 初始設計時並未考慮現代網路威脅，因此面臨以下問題：</p><ul><li>資料採用明文傳輸，容易有遭竊聽的風險</li><li>缺乏身份驗證機制，攻擊者可偽裝成合法主站發送指令</li><li>沒有加密與完整性驗證，易遭中間人攻擊</li></ul><p>為了解決這些問題，IEC 推出了 <a href="https://www.iec.ch/blog/cyber-security-understanding-iec-62351"><strong>IEC 62351</strong> 系列標準</a>，加強電力通訊方面的資安保護：</p><ul><li><a href="https://webstore.iec.ch/en/publication/68410"><strong>IEC 62351-3</strong></a>：建議在 TCP 上使用 TLS (類似 HTTPS) 來加密資料</li><li><a href="https://webstore.iec.ch/en/publication/65511"><strong>IEC 62351-5</strong></a>：對 IEC 104 應用層新增簽章與序號保護，避免重放攻擊 (replay attack) 與偽造</li><li><a href="https://webstore.iec.ch/en/publication/61822"><strong>IEC 62351-8</strong></a> ＆ <a href="https://webstore.iec.ch/en/publication/66864">IEC 62351-9</a>**：定義了裝置驗證和金鑰管理辦法</li></ul><p>若設備不支援這些功能，則可改用 VPN 或閘道器進行加密傳輸或封包轉發。</p><hr><h2 id="7-實務建議：如何部署安全又穩定的系統"><a href="#7-實務建議：如何部署安全又穩定的系統" class="headerlink" title="7. 實務建議：如何部署安全又穩定的系統"></a>7. 實務建議：如何部署安全又穩定的系統</h2><p>即使已導入 IEC 62351，仍建議採用以下部署建議：</p><ol><li><strong>網路區隔</strong>：SCADA、RTU 等工控網路要與一般企業網路隔離。</li><li><strong>防火牆控制埠存取</strong>：只允許授權的 IP 連接 Port 2404 。</li><li><strong>入侵偵測系統 (IDS)</strong> ：即時監測異常 IEC 104 封包與指令行為。</li><li><strong>安全閘道器</strong>：限制只能傳送特定 IOA&#x2F;Type ID 的資料與指令。</li><li><strong>VPN 加密傳輸</strong>：遠端存取建議透過加密通道保護資料。</li><li><strong>定期更新設備韌體</strong>：修補既有已知漏洞。</li></ol><p>上述策略屬於縱深防禦，能大幅降低攻擊成功的機率。</p>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Traditional Chinese </tag>
            
            <tag> 資訊安全 </tag>
            
            <tag> 工業控制系統 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Secure by Demand: Driving OT Security Transformation Through Strategic Procurement</title>
      <link href="//post/Secure-by-Demand-Driving-OT-Security-Transformation-Through-Strategic-Procurement.html"/>
      <url>//post/Secure-by-Demand-Driving-OT-Security-Transformation-Through-Strategic-Procurement.html</url>
      
        <content type="html"><![CDATA[<p><img src="/post/Secure-by-Demand-Driving-OT-Security-Transformation-Through-Strategic-Procurement/cover_img.jpeg"></p><center>Source: Cybersecurity and Infrastructure Security Agency </center><p>In response to the growing cybersecurity threats facing today’s Industrial Control Systems (ICS) and Operational Technology (OT), the U.S. Cybersecurity and Infrastructure Security Agency (CISA), the National Security Agency (NSA), the Federal Bureau of Investigation (FBI), along with several international government partners, jointly released the “<a href="https://www.cisa.gov/resources-tools/resources/secure-demand-priority-considerations-operational-technology-owners-and-operators-when-selecting">Secure by Demand – Priority Considerations for Operational Technology Owners and Operators When Selecting Digital Products</a>” on January 13, 2025.</p><p>This guide provides OT asset owners and operators with a set of <strong>security-centric procurement priorities</strong>, aimed at accelerating the shift from “<em><strong>Secure by Design</strong></em>” to “<em><strong>Secure by Default</strong></em>” across the digital product supply chain.</p><hr><h2 id="Why-Should-OT-Security-Start-with-Procurement"><a href="#Why-Should-OT-Security-Start-with-Procurement" class="headerlink" title="Why Should OT Security Start with Procurement?"></a>Why Should OT Security Start with Procurement?</h2><p>Historically, OT systems have emphasized availability and stability, often at the cost of integrated cybersecurity.</p><p>Today, attackers no longer target a single organization—they exploit <strong>common vulnerabilities</strong> in OT products such as weak passwords, default credentials, insecure protocols, and lack of logging mechanisms. A successful intrusion can lead to <strong>widespread compromise</strong> across industries and infrastructure sectors.</p><p><strong>Secure by Demand</strong> represents a mindset shift:</p><blockquote><p><strong>Rather than relying on buyers to patch security gaps post-deployment, it calls for vendors to deliver secure-by-default products from the outset.</strong></p></blockquote><hr><h2 id="12-Security-Priorities-for-Selecting-OT-Products"><a href="#12-Security-Priorities-for-Selecting-OT-Products" class="headerlink" title="12 Security Priorities for Selecting OT Products"></a>12 Security Priorities for Selecting OT Products</h2><p><strong>1. Configuration Management</strong><br>Must include change tracking, authorization verification, and secure backup mechanisms to prevent persistent malicious configurations.</p><p><strong>2. Baseline Logging Support</strong><br>Logging of logins, configuration changes, and anomalies should be enabled by default, using open standard formats.</p><p><strong>3. Open Standards Compliance</strong><br>Adoption of interoperable protocols (e.g., <a href="https://en.wikipedia.org/wiki/OPC_Unified_Architecture">OPC UA</a>, <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a>) to enhance portability and prevent vendor lock-in.</p><p><strong>4. Operational Autonomy</strong><br>Buyers must retain full control over system maintenance and not be dependent on vendor-exclusive services or restricted from deploying their security tools.</p><p><strong>5. Data Protection</strong><br>Ensure the confidentiality and integrity of engineering logic, configuration files, and operational data to prevent theft or tampering.</p><p><strong>6. Secure by Default</strong><br>Devices should ship with hardened settings, <strong>disable default passwords and insecure services</strong>, and include all security features out of the box.</p><p><strong>7. Secure Communications</strong><br>Must support certificate-based authentication and provide a <strong>simple deployment process</strong>, even for non-cybersecurity professionals.</p><p><strong>8. Resilience Against Malicious Commands</strong><br>Capable of detecting and rejecting unauthorized or unexpected commands to prevent safety incidents or system disruption.</p><p><strong>9. Strong Authentication</strong><br>Must support phishing-resistant <strong>Multi-Factor Authentication (MFA)</strong> and role-based access control to avoid shared credentials and identity abuse.</p><p><strong>10. Threat Modeling Capability</strong><br>Vendors must provide up-to-date threat models and mitigation strategies to assist buyers in security risk assessments.</p><p><strong>11. Vulnerability Management</strong><br>It should follow comprehensive CVE processes, support coordinated vulnerability disclosure (CVD), and include <strong>Software Bill of Materials (SBOM)</strong> — all while offering free security updates.</p><p><strong>12. Upgrade and Patch Tooling</strong><br>Must support secure update verification, well-documented upgrade procedures, and <strong>seamless OS migration</strong> without additional cost.</p><hr><h2 id="Cultivating-a-Culture-of-Secure-Procurement-The-Buyer’s-Role"><a href="#Cultivating-a-Culture-of-Secure-Procurement-The-Buyer’s-Role" class="headerlink" title="Cultivating a Culture of Secure Procurement: The Buyer’s Role"></a>Cultivating a Culture of Secure Procurement: The Buyer’s Role</h2><blockquote><p><strong>At the core of Secure by Demand is a powerful message: Buyers are the first line of defense in OT cybersecurity.</strong></p></blockquote><p>By demanding products that meet the above security priorities, buyers can:</p><ul><li><strong>Incentivize vendors</strong> to integrate cybersecurity into product design</li><li><strong>Avoid high costs</strong> associated with late-stage remediation</li><li><strong>Proactively address compliance</strong> with emerging regulations like the EU’s <a href="https://digital-strategy.ec.europa.eu/en/policies/nis2-directive">NIS2</a> and <a href="https://digital-strategy.ec.europa.eu/en/policies/cyber-resilience-act">Cyber Resilience Act</a></li></ul><p>At the same time, this approach facilitates the <strong>gradual replacement of aging, hard-to-update systems</strong>, paving the way for sustainable digital transformation.</p><hr><h2 id="Practical-Tips-for-Secure-Procurement"><a href="#Practical-Tips-for-Secure-Procurement" class="headerlink" title="Practical Tips for Secure Procurement"></a>Practical Tips for Secure Procurement</h2><ul><li>Explicitly define security features and certification standards (e.g.,<a href="https://www.isa.org/standards-and-publications/isa-standards/isa-iec-62443-series-of-standards"> ISA&#x2F;IEC 62443</a>) in procurement documents</li><li>Evaluate whether vendors provide <strong>free vulnerability remediation</strong> and long-term security support</li><li>Require <strong>threat models, SBOMs, and secure design documentation</strong> as part of vendor deliverables</li><li>Prioritize products that support <strong>MFA, zero-trust architecture</strong>, and <strong>open standards</strong></li></ul><hr><h2 id="Conclusion-Cybersecurity-is-Not-Just-a-Technical-Concern-It’s-a-Procurement-Decision"><a href="#Conclusion-Cybersecurity-is-Not-Just-a-Technical-Concern-It’s-a-Procurement-Decision" class="headerlink" title="Conclusion: Cybersecurity is Not Just a Technical Concern - It’s a Procurement Decision"></a>Conclusion: Cybersecurity is Not Just a Technical Concern - It’s a Procurement Decision</h2><p><strong>Secure by Demand</strong> reinforces a critical truth:</p><blockquote><p><strong>If security is not built-in by default, the ultimate cost will be much higher.</strong></p></blockquote><p>For OT asset owners, procurement marks the beginning of the security journey.</p><p>For vendors, embedding security into products is no longer optional—it’s a competitive differentiator.</p>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
            <tag> Operational technology </tag>
            
            <tag> Critical Infrastructure Security and Resilience </tag>
            
            <tag> Cybersecurity Best Practices </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Secure by Demand：以採購驅動 OT 系統安全轉型</title>
      <link href="//post/Secure-by-Demand%EF%BC%9A%E4%BB%A5%E6%8E%A1%E8%B3%BC%E9%A9%85%E5%8B%95-OT-%E7%B3%BB%E7%B5%B1%E5%AE%89%E5%85%A8%E8%BD%89%E5%9E%8B.html"/>
      <url>//post/Secure-by-Demand%EF%BC%9A%E4%BB%A5%E6%8E%A1%E8%B3%BC%E9%A9%85%E5%8B%95-OT-%E7%B3%BB%E7%B5%B1%E5%AE%89%E5%85%A8%E8%BD%89%E5%9E%8B.html</url>
      
        <content type="html"><![CDATA[<p><img src="/post/Secure-by-Demand%EF%BC%9A%E4%BB%A5%E6%8E%A1%E8%B3%BC%E9%A9%85%E5%8B%95-OT-%E7%B3%BB%E7%B5%B1%E5%AE%89%E5%85%A8%E8%BD%89%E5%9E%8B/cover_img.jpeg"></p><center>Source: Cybersecurity and Infrastructure Security Agency</center><p>在現今工業控制系統（ICS）與營運技術（OT）面臨日益嚴峻的網路威脅下，CISA、NSA、FBI 協同多國政府單位於 2025&#x2F;1&#x2F;13 聯合發布《<a href="https://www.cisa.gov/resources-tools/resources/secure-demand-priority-considerations-operational-technology-owners-and-operators-when-selecting">Secure by Demand - 營運技術所有者和營運商選擇數位產品時的優先考慮事項</a>》指南，提供 OT 系統採購者一套以資安為主軸的產品選購優先事項，藉此推動供應鏈從「<em><strong>Secure by Design</strong></em>」邁向「<em><strong>Secure by Default</strong></em>」。</p><hr><h2 id="為什麼-OT-安全必須「從採購開始」？"><a href="#為什麼-OT-安全必須「從採購開始」？" class="headerlink" title="為什麼 OT 安全必須「從採購開始」？"></a>為什麼 OT 安全必須「從採購開始」？</h2><p>傳統 OT 系統長期以可用性與穩定性為優先，導致資安設計被犧牲。如今攻擊者不再針對單一企業，而是鎖定共通的 OT 弱點 (諸如弱密碼、預設憑證、不安全協定與缺乏日誌機制……等)，一但駭客進行攻擊即會造成大規模淪陷。</p><blockquote><p><strong>Secure by Demand 轉變思維：不再仰賴買家後期彌補資安漏洞，而是從產品選型階段，要求供應商預設具備資安防護機制。</strong></p></blockquote><hr><h2 id="12-項-OT-產品安全選購重點"><a href="#12-項-OT-產品安全選購重點" class="headerlink" title="12 項 OT 產品安全選購重點"></a>12 項 OT 產品安全選購重點</h2><ol><li><p><strong>組態管理（Configuration Management）</strong>：須具備變更記錄、授權驗證與安全備份機制，防止惡意配置被持久化。</p></li><li><p><strong>基線日誌支援（Baseline Logging Support）</strong>：預設支援記錄登入、組態變更、異常等事件，並使用開放標準格式。</p></li><li><p><strong>開放標準支援（Open Standards Compliance）</strong>：採用通用協定（如 <a href="https://en.wikipedia.org/wiki/OPC_Unified_Architecture">OPC UA</a>、<a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">TLS</a>）提升可移植性與相容性，避免綁定單一廠商。</p></li><li><p><strong>操作自主權（Operational Autonomy）</strong>：買方應可獨立維護系統，不應被強制綁定供應商的專屬服務或限制安全工具安裝。</p></li><li><p><strong>資料保護（Data Protection）</strong>：保護工程邏輯、組態與操作數據的機密性與完整性，避免被竊取或偽造。</p></li><li><p><strong>預設安全設定（Secure by Default）</strong>：設備出廠即封鎖不安全服務、停用預設密碼並預載強化設定。</p></li><li><p><strong>安全通訊（Secure Communications）</strong>：支援憑證驗證，並簡化部署流程，使非資安專家亦可完成加密連線設定。</p></li><li><p><strong>安全控制指令處理（Resilience Against Malicious Commands）</strong>：具備辨識惡意或非預期指令的能力，避免被用於觸發故障或安全事件。</p></li><li><p><strong>強化身份驗證（Strong Authentication）</strong>：採用 <a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">MFA</a>、多層權限管理，避免共用帳號與釣魚攻擊。</p></li><li><p><strong>威脅建模能力（Threat Modeling Capability）</strong>：製造商需提供詳細威脅模型與對應防禦機制，協助買方風險評估。</p></li><li><p><strong>弱點管理（Vulnerability Management）</strong>：具備完整 CVE 處理流程、漏洞揭露政策與 SBOM（軟體物料清單），並免費提供安全更新。</p></li><li><p><strong>更新與修補機制（Upgrade and Patch Tooling）</strong>：提供自動驗證更新、相關文件完善的升級流程、並支援無縫移轉至新作業系統。</p></li></ol><hr><h2 id="建立安全採購文化：買方的角色轉變"><a href="#建立安全採購文化：買方的角色轉變" class="headerlink" title="建立安全採購文化：買方的角色轉變"></a>建立安全採購文化：買方的角色轉變</h2><blockquote><p><strong>Secure by Demand 的關鍵在於：買方成為 OT 安全的第一道關卡。</strong></p></blockquote><p>透過要求上述安全特徵，買方可：</p><ul><li><strong>驅動廠商強化產品資安設計</strong></li><li><strong>避免後期補救導致高昂成本</strong></li><li><strong>提前因應歐盟 <a href="https://digital-strategy.ec.europa.eu/en/policies/nis2-directive">NIS2</a>、<a href="https://digital-strategy.ec.europa.eu/en/policies/cyber-resilience-act">Cyber Resilience Act</a> 等合規要求</strong></li></ul><p>同時，也能逐步汰換使用壽命長、難以更新的老舊設備，為數位轉型鋪路。</p><hr><h2 id="建議採購流程實踐要點"><a href="#建議採購流程實踐要點" class="headerlink" title="建議採購流程實踐要點"></a>建議採購流程實踐要點</h2><ul><li>在招標文件中明確要求安全功能與驗證標準（如 <a href="https://www.isa.org/standards-and-publications/isa-standards/isa-iec-62443-series-of-standards">ISA&#x2F;IEC 62443</a>）</li><li>評估供應商是否提供免費的漏洞修補與資安支援週期</li><li>要求提供產品威脅模型、SBOM、安全設計白皮書</li><li>優先選用支援 MFA、零信任架構、開放標準的產品</li></ul><hr><h2 id="結語：資安，不只是技術問題，更是採購決策"><a href="#結語：資安，不只是技術問題，更是採購決策" class="headerlink" title="結語：資安，不只是技術問題，更是採購決策"></a>結語：資安，不只是技術問題，更是採購決策</h2><blockquote><p><strong>Secure by Demand 強調：若安全不是預設，最終將付出更高代價。</strong></p></blockquote><p>對 OT 業主而言，採購就是防線起點；對廠商而言，產品內建資安就是未來競爭力的關鍵。</p>]]></content>
      
      
      <categories>
          
          <category> Knowledge base </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Traditional Chinese </tag>
            
            <tag> 運營技術 </tag>
            
            <tag> 關鍵基礎設施安全與韌性 </tag>
            
            <tag> 網路安全最佳實踐 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
